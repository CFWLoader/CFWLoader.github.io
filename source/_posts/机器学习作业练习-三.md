---
title: 机器学习作业练习(三)
date: 2018-04-16 19:32:43
tags:
	- 机器学习
	- 作业练习
	- 多层感知机
	- R
categories:	机器学习
---

### 题目3.1 - 误差逆向传播公式推导

设$y_T^{(\alpha)} \in \{0, 1\}$为训练集的输出，$y(x;w)$为网络的输出，误差函数：

$$
E^T = \frac{1}{p} \sum_{\alpha = 0}^{p} e^{(\alpha)}
$$

其中：

$$
e^{(\alpha)} = - [y_T^{(\alpha)} ln y(x^{(\alpha)}; w) + (1 - y_T^{(\alpha)}) ln (1 - y(x^{(\alpha)}; w))]
$$

第一问求证：

$$
\frac{\partial e^{(\alpha)}}{\partial y(x^{(\alpha)}; w)} = \frac{y(x^{(\alpha)}; w) - y_T^{(\alpha)}}{y(x^{(\alpha)}; w)(1 - y(x^{(\alpha)}; w))}
$$

这些符号里面的上下标太让人眼花了，笔者首先用其他符号代表一下：

$$
\begin{align}
e & = e^{(\alpha)} \\
a & = y(x^{(\alpha)}; w) \\
b & = y_T^{(\alpha)}
\end{align}
$$

那么条件就变成了：

$$
e = -[b ln a + (1 - b)ln(1 - a)]
$$

问题就变成了：

$$
\frac{\partial e}{\partial a} = \frac{a - b}{a(1-a)}
$$

开始求解：

$$
\begin{align}
\frac{\partial e}{\partial a} & = \frac{\partial -[b ln a + (1 - b)ln(1 - a)]}{\partial a} \\
& = [-\frac{b}{a} + \frac{1 - b}{1 - a}] \\
& = \frac{-b + ab + a - ab}{a(1 - a)} \\
& = \frac{a - b}{a(1 - a)}
\end{align}
$$

证之。