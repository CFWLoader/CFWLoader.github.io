<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>CFWLoader</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="It&#39;s interesting to solve problems by coding.">
<meta property="og:type" content="website">
<meta property="og:title" content="CFWLoader">
<meta property="og:url" content="https://cfwloader.github.io/page/5/index.html">
<meta property="og:site_name" content="CFWLoader">
<meta property="og:description" content="It&#39;s interesting to solve problems by coding.">
<meta property="og:locale" content="zh_ZN">
<meta property="article:author" content="Evan Huang">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="CFWLoader" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.2.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">CFWLoader</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">A man who codes for fun.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Suche"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Suche"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://cfwloader.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-使用Linux工具分析g-生成的代码" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/11/21/%E4%BD%BF%E7%94%A8Linux%E5%B7%A5%E5%85%B7%E5%88%86%E6%9E%90g-%E7%94%9F%E6%88%90%E7%9A%84%E4%BB%A3%E7%A0%81/" class="article-date">
  <time class="dt-published" datetime="2017-11-21T14:30:05.000Z" itemprop="datePublished">2017-11-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/C-%E6%8A%80%E6%9C%AF/">C++技术</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/11/21/%E4%BD%BF%E7%94%A8Linux%E5%B7%A5%E5%85%B7%E5%88%86%E6%9E%90g-%E7%94%9F%E6%88%90%E7%9A%84%E4%BB%A3%E7%A0%81/">使用Linux工具分析g++生成的代码</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>近来想用实际代码实验来验证《Effective C++》、《深度探索C++对象模型》中的知识，通过反汇编等手段查看编译器生成的代码，原本想着看能不能设置好编译参数，使得编译器可以输出书本中的中间代码，可惜的是暂时还没找到，还一度以为只能通过强行分析汇编码。经过一周的摸索，总算弄出了一个可以接受的方案，这篇博客主要说明几个命令之间生成代码的信息。</p>
<h2 id="环境支持"><a href="#环境支持" class="headerlink" title="环境支持"></a>环境支持</h2><ul>
<li>Linux</li>
<li>g++</li>
<li>gdb</li>
<li>nm</li>
<li>objdump</li>
<li>c++filt</li>
<li>readelf</li>
</ul>
<p>其中<code>g++</code>本身就可以通过添加<code>-S</code>参数就可以生成汇编码了，<code>nm</code>命令用来查看生成二进制文件的函数表，<code>objdump</code>是查看更多关于二进制文件的信息，<code>c++filt</code>命令使用来<code>demangling</code>，<code>readelf</code>用于读取<code>ELF</code>文件信息。</p>
<h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h2><p>《深度探索C++对象模型》中的构造语义章节中提到过，如果有一个<code>Object</code>类，而在声明一个实例的时候:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Object obj;</span><br></pre></td></tr></table></figure>
<p>编译器可能会生成如下的中间代码:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Object obj;</span><br><span class="line">Object::<span class="built_in">Object</span>(&amp;obj);</span><br></pre></td></tr></table></figure>
<p>而生成的函数原型是:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Object::Object</span><span class="params">(Object* <span class="type">const</span> <span class="keyword">this</span>)</span></span>;</span><br></pre></td></tr></table></figure>
<p>此实验的目的就是验证编译器确实是生成了这样的中间代码。结论是目前只有<code>gdb</code>能做到，在呈现成果的结果前，也试试用别的命令看看能够尝试到什么样的结果。</p>
<h2 id="x86-64汇编相关的准备知识"><a href="#x86-64汇编相关的准备知识" class="headerlink" title="x86_64汇编相关的准备知识"></a>x86_64汇编相关的准备知识</h2><p>一旦开始做这类C++相关代码分析的工作，汇编是逃不开的，不过现在也基本不用写，会读就可以了。<code>g++</code>生成的汇编码是<code>AT&amp;T</code>格式的，64位机的条件下，每个涉及到操作数的命令中后面会带有<code>b</code>、<code>w</code>、<code>l</code>、<code>q</code>等字母，分别代表操作一个1Byte(8 bit)、2 Byte(16bit)、4 Byte(32bit)以及8 Byte(64bit)。例如:</p>
<ul>
<li><code>movb %al, %bl</code>代表把<code>ax</code>寄存器的低8bit赋值给<code>bx</code>寄存器的低8bit。</li>
<li><code>movw %ax, %bx</code>代表把<code>ax</code>中16bit的值赋值给<code>bx</code>寄存器。</li>
<li><code>movl %eax, %ebx</code>代表把<code>eax</code>中32bit的值赋值予<code>ebx</code>寄存器。</li>
<li><code>movq %rax, %rbx</code>代表把<code>rax</code>中64bit的值赋予<code>rbx</code>寄存器。</li>
</ul>
<p>x86_64有16个64bit寄存器，分别为%rax，%rbx，%rcx，%rdx，%esi，%edi，%rbp，%rsp，%r8，%r9，%r10，%r11，%r12，%r13，%r14，%r15。笔者所用的<code>Linux</code>下的<code>g++</code>编译器一般会这样划分寄存器的用途:</p>
<ul>
<li>%rax 作为函数返回值使用。</li>
<li>%rsp 栈指针寄存器，指向栈顶。</li>
<li>%rdi，%rsi，%rdx，%rcx，%r8，%r9 用作函数参数，依次对应第1参数，第2参数…</li>
<li>%rbx，%rbp，%r12，%r13，%14，%15 用作数据存储，遵循被调用者使用规则，简单说就是随便用，调用子函数之前要备份它，以防他被修改。</li>
<li>%r10，%r11 用作数据存储，遵循调用者使用规则，简单说就是使用之前要先保存原值。</li>
</ul>
<h2 id="实验用的代码"><a href="#实验用的代码" class="headerlink" title="实验用的代码"></a>实验用的代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Object</span></span><br><span class="line">{</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Object</span>()</span><br><span class="line">	{}</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	Object obj;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>这里需要定义<code>Object::Object()</code>，因为编译器在这里不会自动合成<code>Object</code>类的构造函数。如果连<code>Object</code>类是个空类，没有函数成员，也没有数据成员，编译器会为这个类生成怎样的代码?这个问题也在《深度探索C++对象模型》中提到过，有兴趣者可以通过搜索<code>空基类优化</code>关键字获得相关的知识，这里就不展开细说了。</p>
<h2 id="nm命令"><a href="#nm命令" class="headerlink" title="nm命令"></a>nm命令</h2><p><code>nm</code>命令是用于列出目标文件中的符号，在这个实验中用作输出函数签名，查找看能不能输出期望的<code>void Object::Object(Object * const)</code>的函数签名。</p>
<p>首先使用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ g++ main.cpp</span><br></pre></td></tr></table></figure>
<p>生成目标文件<code>a.out</code>。随后:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nm a.out | c++filt</span><br></pre></td></tr></table></figure>
<p>可以看到终端输出(经过处理):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0000000000400566 T main</span><br><span class="line">0000000000400588 W Object::Object()</span><br><span class="line">0000000000400588 W Object::Object()</span><br></pre></td></tr></table></figure>
<p>信息还不少，可惜没有找到期待的<code>void Object::Object(Object * const)</code>。</p>
<h2 id="objdump"><a href="#objdump" class="headerlink" title="objdump"></a>objdump</h2><p>不改动上述的<code>a.out</code>文件，执行:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ objdump -t a.out | c++filt</span><br></pre></td></tr></table></figure>
<p>也是输出了不少信息(经过处理):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0000000000400566 g     F .text	0000000000000022              main</span><br><span class="line">0000000000400588  w    F .text	000000000000000b              Object::Object()</span><br><span class="line">0000000000400588  w    F .text	000000000000000b              Object::Object()</span><br></pre></td></tr></table></figure>
<p>当前只关注能不能找到<code>void Object::Object(Object * const)</code>，所以这里也不展开介绍这个命令输出的内容。</p>
<h2 id="readelf"><a href="#readelf" class="headerlink" title="readelf"></a>readelf</h2><p>不改动上述的<code>a.out</code>文件，执行:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ readelf -s a.out | c++filt</span><br></pre></td></tr></table></figure>
<p>也是输出了不少信息(经过处理):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">55: 0000000000400588    11 FUNC    WEAK   DEFAULT   11 Object::Object()</span><br><span class="line">60: 0000000000400588    11 FUNC    WEAK   DEFAULT   11 Object::Object()</span><br><span class="line">63: 0000000000400566    34 FUNC    GLOBAL DEFAULT   11 main</span><br></pre></td></tr></table></figure>
<p>也能获得不少关于符号表中的信息，可惜没有期待的<code>void Object::Object(Object * const)</code>。</p>
<h2 id="直接查看g-生成的汇编码"><a href="#直接查看g-生成的汇编码" class="headerlink" title="直接查看g++生成的汇编码"></a>直接查看g++生成的汇编码</h2><p>还是上述的<code>C++</code>代码，不过不是分析编译器生成目标文件，而是通过:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ g++ -S main.cpp</span><br></pre></td></tr></table></figure>
<p>生成汇编文件<code>main.s</code>，不过需要给这个文件进行一下<code>demangling</code>，不然没法看:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cat</span> main.s | c++filt </span><br></pre></td></tr></table></figure>
<p>会输出(经过处理):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Object::Object():</span><br><span class="line">	pushq	%rbp</span><br><span class="line">	movq	%rsp, %rbp</span><br><span class="line">	movq	%rdi, -8(%rbp)</span><br><span class="line">	nop</span><br><span class="line">	popq	%rbp</span><br><span class="line">	ret</span><br><span class="line"></span><br><span class="line">main:</span><br><span class="line">	pushq	%rbp</span><br><span class="line">	movq	%rsp, %rbp</span><br><span class="line">	subq	$32, %rsp</span><br><span class="line">	movl	%edi, -20(%rbp)</span><br><span class="line">	movq	%rsi, -32(%rbp)</span><br><span class="line">	leaq	-1(%rbp), %rax</span><br><span class="line">	movq	%rax, %rdi</span><br><span class="line">	call	Object::Object()</span><br><span class="line">	movl	$0, %eax</span><br><span class="line">	leave</span><br><span class="line">	ret</span><br></pre></td></tr></table></figure>
<p>还是看不到《对象模型》中所说的<code>void Object::Object(Object * const)</code>函数签名。不过注意到<code>Object::Object():</code>中有一句:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">movq	%rdi, -8(%rbp)</span><br></pre></td></tr></table></figure>
<p>这句汇编的意思是把%rdi寄存器中的值赋予%rbp前移8个字节的内存地址中，即复制了64bit数据。<br>前面提到:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%rdi，%rsi，%rdx，%rcx，%r8，%r9 用作函数参数，依次对应第1参数，第2参数...</span><br></pre></td></tr></table></figure>
<p>那是不是有什么参数传入到了这个函数过程中了呢?不过我们现在暂时没有办法得知，需要后面提到的<code>gdb</code>帮助下才能验证。</p>
<h2 id="强力工具gdb"><a href="#强力工具gdb" class="headerlink" title="强力工具gdb"></a>强力工具gdb</h2><p>本实验只用到<code>gdb</code>的一小部分功能，之前使用搜索引擎的时候，发现都可以用<code>gdb</code>调试多线程程序了，命令也挺简单，可以进入某一线程中进行调试。</p>
<p>回到本实验上，使用<code>gdb</code>前编译目标文件:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ g++ -g main.cpp</span><br></pre></td></tr></table></figure>
<p>添加<code>-g</code>是为了让生成的目标文件带有调试信息。</p>
<p>执行:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gdb a.out</span><br></pre></td></tr></table></figure>
<p>进入调试。首先使用:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ (gdb) info <span class="built_in">functions</span></span><br></pre></td></tr></table></figure>
<p>会看到输出(经过处理):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">File main.cpp:</span><br><span class="line">void Object::Object();</span><br><span class="line">int main(int, char**);</span><br></pre></td></tr></table></figure>
<p>还是看不到我们想要的<code>void Object::Object(Object * const)</code>，但是使用了万能的:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ (gdb) <span class="built_in">print</span> Object::Object</span><br></pre></td></tr></table></figure>
<p>看到了输出:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$1 = {void (Object * const)} 0x400588 &lt;Object::Object()&gt;</span><br></pre></td></tr></table></figure>
<p>这里说明了经过输出美化的<code>Object::Object()</code>真正的函数签名是<code>void Object::Object(Object * const)</code>，这个实验的基本目的就达到了。</p>
<p>上面提到生成的汇编码中有暗示传入参数到<code>Object::Object()</code>的疑点，现在就用步进模式运行程序:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ (gdb) start</span><br></pre></td></tr></table></figure>
<p>然后键入<code>s</code>或者<code>step</code>一步一步执行，进入了<code>Object::Object()</code>函数执行内部:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Object::Object (this=0x7fffffffddcf) at main.cpp:5</span><br><span class="line">5		{}</span><br></pre></td></tr></table></figure>
<p>注意到这个<code>this=0x7fffffffddcf</code>，这个是什么变量的地址值?在这里执行:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ (gdb) <span class="built_in">print</span> &amp;obj</span><br></pre></td></tr></table></figure>
<p>可惜当前<code>Object::Object()</code>上下文不存在这个变量，只能键入<code>s</code>进行到下一步回到<code>main()</code>中执行，得到:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$2 = (Object *) 0x7fffffffddcf</span><br></pre></td></tr></table></figure>
<p>证明了<code>void Object::Object(Object * const)</code>是需要传入一个<code>Object * const</code>参数作为执行的上下文的。到了这里，忘了在<code>Object::Object()</code>上下文中检查上面提到的寄存器们了，只能用<code>s</code>或者<code>n</code>执行完这次，然后再次<code>start</code>并进入到<code>Object::Object()</code>的上下文中了，此时执行:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ (gdb) info registers</span><br></pre></td></tr></table></figure>
<p>得到:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rax            0x7fffffffddcf	140737488346575</span><br><span class="line"></span><br><span class="line">rdi            0x7fffffffddcf	140737488346575</span><br><span class="line"></span><br><span class="line">rbp            0x7fffffffdda0	0x7fffffffdda0</span><br><span class="line">rsp            0x7fffffffdda0	0x7fffffffdda0</span><br></pre></td></tr></table></figure>
<p>好了，根据上面所说的<code>rdi</code>作为存储函数参数地址的寄存器，那么其中存储的<code>0x7fffffffddcf</code>跟<code>&amp;obj</code>的输出值对上了，也证明了<code>Object::Object()</code>真正的函数签名是<code>void Object::Object(Object * const)</code>。</p>
<p>证明完了之后，上面还特意贴出了<code>rax</code>寄存器中的值，也是<code>0x7fffffffddcf</code>，上面也提到:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%rax 作为函数返回值使用。</span><br></pre></td></tr></table></figure>
<p>那么，最终Object::Object真正函数签名是<code>Object* Object::Object(Object * const)</code>呢?是的，然而这个函数是返回<code>void</code>，只要我们使用着这个编译器，我们便无法从其提供的语法层面获得这个返回值。</p>
<p>这个简单的实验，也从侧面说明了<code>C++</code>这个语言是有多复杂，编译器做了多少的小动作，不花点心思和用点工具，使用者只能看着编译出来的黑箱运行，用点<code>printf</code>或者<code>cout</code>看看是否正确运行。</p>
<p>至此，这个寻找类构造函数真正的签名的实验到此为止。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://cfwloader.github.io/2017/11/21/%E4%BD%BF%E7%94%A8Linux%E5%B7%A5%E5%85%B7%E5%88%86%E6%9E%90g-%E7%94%9F%E6%88%90%E7%9A%84%E4%BB%A3%E7%A0%81/" data-id="clximfz6t002k7kkv8zwnaymg" data-title="使用Linux工具分析g++生成的代码" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/" rel="tag">C++</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gdb/" rel="tag">gdb</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Apriori算法实现" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/11/20/Apriori%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0/" class="article-date">
  <time class="dt-published" datetime="2017-11-20T14:33:59.000Z" itemprop="datePublished">2017-11-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98/">数据挖掘</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/11/20/Apriori%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0/">Apriori算法实现</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>数据挖掘作为当前比较热门的领域之一，已经有较为权威的书籍指导入门了，如陈封能著，范明译的《数据挖掘导论》以及力量黑书(机械工业出版社)出版的《数据挖掘概念与技术》。</p>
<p>在介绍完基本的数据挖掘概念之后，第一个动手写代码实现的算法就是<code>Apriori</code>算法了。<code>Apriori</code>算法是用于挖掘关联规则的频繁项集算法。</p>
<h2 id="环境支持"><a href="#环境支持" class="headerlink" title="环境支持"></a>环境支持</h2><ul>
<li>   Python 3.5</li>
<li>   美国国会84年投票记录<a target="_blank" rel="noopener" href="http://archive.ics.uci.edu/ml/machine-learning-databases/voting-records/house-votes-84.data">UCI下载链接</a></li>
</ul>
<h2 id="Apriori中的剪枝步骤"><a href="#Apriori中的剪枝步骤" class="headerlink" title="Apriori中的剪枝步骤"></a>Apriori中的剪枝步骤</h2><p>在介绍伪代码前要介绍<code>Apriori</code>算法中的<code>剪枝</code>步骤。在产生<code>K=1,...</code>频繁项集的过程中，一共有<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.777ex;" xmlns="http://www.w3.org/2000/svg" width="8.316ex" height="2.949ex" role="img" focusable="false" viewbox="0 -960 3675.6 1303.3"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="munderover"><g data-mml-node="mo"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"/></g><g data-mml-node="TeXAtom" transform="translate(1089,477.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"/></g></g><g data-mml-node="TeXAtom" transform="translate(1089,-285.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="mn" transform="translate(1123,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/></g></g></g><g data-mml-node="msubsup" transform="translate(2453.3,0)"><g data-mml-node="mi"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"/></g><g data-mml-node="mi" transform="translate(845.3,363) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mi" transform="translate(748,-247) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/></g></g></g></g></svg></mjx-container>个候选集，不用百万级的数据，光是<code>n</code>大于1000的时候都可以产生组合爆炸，更别说对产生的组合进行统计。所以<code>Apriori</code>算法在统计候选集之前先要把产生的<code>K</code>候选集作一个剪枝，删除不频繁的<code>K</code>候选集再开始统计。</p>
<p>具体的做法是检验该<code>K</code>项集的<code>K-1</code>子项集是否为频繁项集，如果该<code>K</code>项集的所有子项集都是频繁项集，那么该<code>K</code>项集才有可能是频繁项集。</p>
<p>假设有<code>{A,B,C,D}</code>这个全集，在<code>K=3</code>有<code>{A,B,C}</code>和<code>{A,B,D}</code>等组合(其它组合情况省略)。设频繁阈值为1，而<code>K-1</code>时存在<code>{\{A,B},{A,C\}}</code>项集而没有<code>{A，D}</code>项集，那么<code>{A,B,D}</code>肯定不是频繁项集，因而在下一轮统计前就可以删除了。</p>
<h2 id="Apriori算法伪代码"><a href="#Apriori算法伪代码" class="headerlink" title="Apriori算法伪代码"></a>Apriori算法伪代码</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line">	D:	事务数据库</span><br><span class="line">	min_sup: 最小支持度阈值</span><br><span class="line">Ouput:</span><br><span class="line">	L,D中的频繁项集</span><br><span class="line">Procedure:</span><br><span class="line">	L1=find_frequent_1_itemsets(D);</span><br><span class="line">	for(k=2; Lk-1!=EmptySet; k++)</span><br><span class="line">	{</span><br><span class="line">		Ck=apriori_gen(Lk-1);</span><br><span class="line">		for each transaction t in D 		// 	扫描D,进行计数</span><br><span class="line">		{		</span><br><span class="line">			Ct=subset(Ck,t);				//	得到t的子集，候选集</span><br><span class="line">			for each candidate c in Ct </span><br><span class="line">			{</span><br><span class="line">				c.count++;</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">		Lk={c(Ck|c.count&gt;=min_sup)}</span><br><span class="line">	}</span><br><span class="line">	return L union_k Lk;</span><br><span class="line"></span><br><span class="line">Procedure apriori_gen(Lk-1: frequent(k-1)itemset)</span><br><span class="line">	for each itemset l1 in Lk-1</span><br><span class="line">	{</span><br><span class="line">		for each itemset l2 in Lk-1</span><br><span class="line">		{</span><br><span class="line">			if(l1[1]=l2[1])and...and(l1[k-2]=l2[k-2])and(l1[k-1]&lt;l2[k-1]) then</span><br><span class="line">			{</span><br><span class="line">				c=l1 × l2 (Cartesian product)</span><br><span class="line">				if has_infrequent_subset(c, Lk-1) then</span><br><span class="line">					delete c;						// 删除非频繁的候选</span><br><span class="line">				else</span><br><span class="line">					add c to Ck;</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	return Ck;</span><br><span class="line"></span><br><span class="line">Procedure has_infrequent_subset(c: candidate k itemset; Lk-1: frequent(k-1)itemset)</span><br><span class="line">	for each (k-1) subset s of c</span><br><span class="line">	{</span><br><span class="line">		if s not in Lk-1 then</span><br><span class="line">			return true;</span><br><span class="line">	}</span><br><span class="line">	return false;</span><br></pre></td></tr></table></figure>

<p>简单介绍了基本概念以及算法之后，一般读者都会迷迷糊糊的，这很正常，毕竟这篇博客是用来讲实现了，伪代码也因为Markdown的代码块里面不允许加载特殊html语法写得难看。建议真的想搞懂的话，就去看上述的书，然后手解模拟一下过程，一般懂了之后，实现的问题就不大了。</p>
<p>如上述环境支持，在这里实现的时候用的是美国国会84年的投票记录，实际上是什么数据集并没有关系，无非就是数据预处理的过程不一样了而已。针对这个数据集，笔者实现了如下代码用于加载与处理一行记录:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">translate_record</span>(<span class="params">record</span>):</span><br><span class="line">    items = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> record[<span class="number">0</span>] == <span class="string">'republican'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'rep'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> record[<span class="number">0</span>] == <span class="string">'democrat'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'demo'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> record[<span class="number">1</span>] == <span class="string">'y'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'hci'</span>)  <span class="comment"># handicapped-infants</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> record[<span class="number">1</span>] == <span class="string">'n'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'hci-n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> record[<span class="number">2</span>] == <span class="string">'y'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'wpcs'</span>)  <span class="comment"># water-project-cost-sharing</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> record[<span class="number">2</span>] == <span class="string">'n'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'wpcs-n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> record[<span class="number">3</span>] == <span class="string">'y'</span>:</span><br><span class="line">        items.append(<span class="string">'aotbr'</span>)  <span class="comment"># adoption-of-the-budget-resolution</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> record[<span class="number">3</span>] == <span class="string">'n'</span>:</span><br><span class="line">        items.append(<span class="string">'aotbr-n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> record[<span class="number">4</span>] == <span class="string">'y'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'pff'</span>)  <span class="comment"># physician-fee-freeze</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> record[<span class="number">4</span>] == <span class="string">'n'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'pff-n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> record[<span class="number">5</span>] == <span class="string">'y'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'esa'</span>)  <span class="comment"># el-salvador-aid</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> record[<span class="number">5</span>] == <span class="string">'n'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'esa-n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> record[<span class="number">6</span>] == <span class="string">'y'</span>:</span><br><span class="line">        items.append(<span class="string">'rgis'</span>)  <span class="comment"># religious-groups-in-schools</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> record[<span class="number">6</span>] == <span class="string">'n'</span>:</span><br><span class="line">        items.append(<span class="string">'rgis-n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> record[<span class="number">7</span>] == <span class="string">'y'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'astb'</span>)  <span class="comment"># anti-satellite-test-ban</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> record[<span class="number">7</span>] == <span class="string">'n'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'astb-n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> record[<span class="number">8</span>] == <span class="string">'y'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'atnc'</span>)  <span class="comment"># aid-to-nicaraguan-contras</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> record[<span class="number">8</span>] == <span class="string">'n'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'atnc-n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> record[<span class="number">9</span>] == <span class="string">'y'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'mxm'</span>)  <span class="comment"># mx-missile</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> record[<span class="number">9</span>] == <span class="string">'n'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'mxm-n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> record[<span class="number">10</span>] == <span class="string">'y'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'imm'</span>)  <span class="comment"># immigration</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> record[<span class="number">10</span>] == <span class="string">'n'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'imm-n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> record[<span class="number">11</span>] == <span class="string">'y'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'scc'</span>)  <span class="comment"># synfuels-corporation-cutback</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> record[<span class="number">11</span>] == <span class="string">'n'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'scc-n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> record[<span class="number">12</span>] == <span class="string">'y'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'es'</span>)  <span class="comment"># education-spending</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> record[<span class="number">12</span>] == <span class="string">'n'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'es-n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> record[<span class="number">13</span>] == <span class="string">'y'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'srts'</span>)  <span class="comment"># superfund-right-to-sue</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> record[<span class="number">13</span>] == <span class="string">'n'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'srts-n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> record[<span class="number">14</span>] == <span class="string">'y'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'cri'</span>)  <span class="comment"># crime</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> record[<span class="number">14</span>] == <span class="string">'n'</span>:</span><br><span class="line"></span><br><span class="line">        items.append(<span class="string">'cri-n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> record[<span class="number">15</span>] == <span class="string">'y'</span>:</span><br><span class="line">        items.append(<span class="string">'dfe'</span>)  <span class="comment"># duty-free-exports</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> record[<span class="number">15</span>] == <span class="string">'n'</span>:</span><br><span class="line">        items.append(<span class="string">'dfe-n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> record[<span class="number">16</span>] == <span class="string">'y'</span>:</span><br><span class="line">        items.append(<span class="string">'eaasa'</span>)  <span class="comment"># export-administration-act-south-africa</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> record[<span class="number">16</span>] == <span class="string">'n'</span>:</span><br><span class="line">        items.append(<span class="string">'eaasa-n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> items</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_data</span>(<span class="params">file_path</span>):</span><br><span class="line">    src_data = <span class="built_in">open</span>(file_path)</span><br><span class="line"></span><br><span class="line">    votes_records = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> src_data:</span><br><span class="line">        votes_records.append(translate_record(line.strip(<span class="string">'\n'</span>).split(<span class="string">','</span>)))</span><br><span class="line"></span><br><span class="line">    src_data.close()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> votes_records</span><br></pre></td></tr></table></figure>
<p>其中，<code>load_data</code>用于读入数据集并返回一个处理好的数据列表。</p>
<p>然后就是伪代码第一行，就是产生1项集，并统计1频繁项集:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">find_frequent_1_itemsets</span>(<span class="params">vote_records, min_sup=<span class="number">0</span></span>):</span><br><span class="line">    itemsets = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> record <span class="keyword">in</span> vote_records:</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> element <span class="keyword">in</span> record:</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> [element] <span class="keyword">not</span> <span class="keyword">in</span> itemsets:</span><br><span class="line">                itemsets.append([element])</span><br><span class="line"></span><br><span class="line">    itemsets = <span class="built_in">map</span>(<span class="built_in">frozenset</span>, itemsets)						<span class="comment"># 使用frozenset使得集合可以作为dict中的key</span></span><br><span class="line"></span><br><span class="line">    itemsets_with_count = {}</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> candidate <span class="keyword">in</span> itemsets:								<span class="comment"># 产生候选项</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> record <span class="keyword">in</span> vote_records:</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> candidate.issubset(record):					<span class="comment"># 如果该候选是记录中的子集，增加计数值</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> candidate <span class="keyword">in</span> itemsets_with_count:</span><br><span class="line"></span><br><span class="line">                    itemsets_with_count[candidate] += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">                    itemsets_with_count[candidate] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    qualified_itemsets = {}</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> key, val <span class="keyword">in</span> itemsets_with_count.items():			<span class="comment"># 筛选候选项</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> val &gt;= min_sup:</span><br><span class="line"></span><br><span class="line">            qualified_itemsets[key] = val</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> qualified_itemsets</span><br></pre></td></tr></table></figure>
<p>注意，为了能够用<code>dict</code>来统计频繁项集的个数，其中的<code>key</code>的类型是一个集合，而一般的集合是不能来当作<code>key</code>的，幸好python提供了<code>frozenset</code>使得集合作为<code>dict</code>的<code>key</code>。不过这样的实现也有很大的性能缺陷，频繁地在普通的集合以及<code>frozenset</code>中转化，深度复制，性能损失可想而知。</p>
<p>当时实现的时候一个优化的想法就是用一个4Byte的数据结构来表示一个集合，其中的<code>0</code>和<code>1</code>分别代表<code>yes</code>和<code>no</code>，然而数据还存在第三个状态，用扩展位来解决这个问题，可以通过拼凑的方法使得这样的数据结构可以兼容任意个选项。这样的方法通用性不好，加上这里是第一次实现，所以就还是采取<code>frozenset</code>这个平凡的办法来处理了。</p>
<p>然后在<code>K&gt;=2</code>开始，需要用到的<code>has_infrequent_set</code>,用于检测该候选项是否存在非频繁子项集:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">has_infrequent_set</span>(<span class="params">un_set, frozen_set</span>):</span><br><span class="line"></span><br><span class="line">    unfrozen_un = <span class="built_in">set</span>(un_set)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ele <span class="keyword">in</span> unfrozen_un:</span><br><span class="line"></span><br><span class="line">        sub_k_1_set = unfrozen_un.copy()		<span class="comment"># 复制该候选项，并一次迭代中删除一个元素，产生子集</span></span><br><span class="line"></span><br><span class="line">        sub_k_1_set.remove(ele)</span><br><span class="line"></span><br><span class="line">        sub_k_1_set = <span class="built_in">frozenset</span>(sub_k_1_set)	<span class="comment"># frozen化使之能够成为索引</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> sub_k_1_set <span class="keyword">not</span> <span class="keyword">in</span> frozen_set:		<span class="comment"># 如果子集不在频繁项集中，则为非频繁项集</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>
<p>这里就体现出了普通的集合和<code>frozenset</code>的频繁转化了。</p>
<p>接下来是产生<code>K(K&gt;1)</code>项集的<code>apriori_gen</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">apriori_gen</span>(<span class="params">lk</span>):</span><br><span class="line"></span><br><span class="line">    frozen_set = lk.keys()									<span class="comment"># 取出K-1项集</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(frozen_set) &lt;= <span class="number">0</span>:</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ele <span class="keyword">in</span> frozen_set: set_size = <span class="built_in">len</span>(ele) + <span class="number">1</span>; <span class="keyword">break</span>	<span class="comment"># 设定K的值</span></span><br><span class="line"></span><br><span class="line">    gen_set = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ele1 <span class="keyword">in</span> frozen_set:</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> ele2 <span class="keyword">in</span> frozen_set:</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> (ele1.issubset(ele2) <span class="keyword">and</span> ele1.issuperset(ele2)):	<span class="comment"># 如果不是同一个集合</span></span><br><span class="line"></span><br><span class="line">                un_set = ele1.union(ele2)							<span class="comment"># 取并集</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(un_set) == set_size <span class="keyword">and</span> un_set <span class="keyword">not</span> <span class="keyword">in</span> gen_set <span class="keyword">and</span> <span class="keyword">not</span> has_infrequent_set(un_set, frozen_set):</span><br><span class="line">                	<span class="comment"># 测试并集是否为K项集并且还未被之前的过程产生，而且没有非频繁K-1子集</span></span><br><span class="line">                    gen_set.append(un_set)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> gen_set</span><br></pre></td></tr></table></figure>
<p>准备好<code>Apriori</code>用到的主要过程之后，就是<code>Apriori</code>算法的主体了:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">apriori</span>(<span class="params">record_set, min_sup</span>):</span><br><span class="line"></span><br><span class="line">    l1 = find_frequent_1_itemsets(record_set, min_sup)	<span class="comment"># 产生1项集</span></span><br><span class="line"></span><br><span class="line">    L = [l1]</span><br><span class="line"></span><br><span class="line">    k = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(L[k - <span class="number">1</span>]) &gt; <span class="number">0</span>:							<span class="comment"># 只要K频繁项集还有，算法就不结束</span></span><br><span class="line"></span><br><span class="line">        ck = apriori_gen(L[k - <span class="number">1</span>])						<span class="comment"># 从K-1项集中产生K项</span></span><br><span class="line"></span><br><span class="line">        count_set = {}</span><br><span class="line"></span><br><span class="line">        verified_count_set = {}</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> candidate <span class="keyword">in</span> ck:							<span class="comment"># 统计产生的K项集的支持度</span></span><br><span class="line"></span><br><span class="line">            count_set[candidate] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> record <span class="keyword">in</span> record_set:</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> candidate.issubset(record):</span><br><span class="line"></span><br><span class="line">                    count_set[candidate] += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> key, val <span class="keyword">in</span> count_set.items():				<span class="comment"># 统计符合要求的K频繁项</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> val &gt;= min_sup:</span><br><span class="line"></span><br><span class="line">                verified_count_set[key] = val</span><br><span class="line"></span><br><span class="line">        L.append(verified_count_set.copy())				<span class="comment"># 加入到结果中，准备下一轮迭代</span></span><br><span class="line"></span><br><span class="line">        count_set.clear()</span><br><span class="line"></span><br><span class="line">        verified_count_set.clear()</span><br><span class="line"></span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> L</span><br></pre></td></tr></table></figure>
<p>经典的<code>Apriori</code>算法的主体代码实现就到这里就结束了。</p>
<p>算法实现并不难，难得是弄懂这个过程，所以还是看书，自己手动模拟过程更快一些。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://cfwloader.github.io/2017/11/20/Apriori%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0/" data-id="clximfz6e00017kkv4e1uf6lu" data-title="Apriori算法实现" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98/" rel="tag">数据挖掘</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0/" rel="tag">算法实现</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%A2%91%E7%B9%81%E6%A8%A1%E5%BC%8F%E6%8C%96%E6%8E%98/" rel="tag">频繁模式挖掘</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-diff命令学习笔记" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/11/17/diff%E5%91%BD%E4%BB%A4%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="article-date">
  <time class="dt-published" datetime="2017-11-17T11:00:58.000Z" itemprop="datePublished">2017-11-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Linux/">Linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/11/17/diff%E5%91%BD%E4%BB%A4%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">diff命令学习笔记</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>只要一直使用着Linux作为主要的工作操作系统，并且经常码代码的话，总有一天会用到<code>diff</code>命令，前面笔者太依赖于git环境了，以致于疏忽了学习这个命令，这段时间又用到了，于是记下来。</p>
<h3 id="读懂diff输出含义"><a href="#读懂diff输出含义" class="headerlink" title="读懂diff输出含义"></a>读懂diff输出含义</h3><p>在不加参数，直接对比两个文件的情况下，输出中有三种结果:</p>
<ol>
<li><code>a</code> - <code>add</code>,即第二个文件比第一个文件多了。</li>
<li><code>d</code> - <code>delete</code>,即第二个文件比地一个文件少了。</li>
<li><code>c</code> - <code>change</code>，即第二个文件同行位置下发生了修改。</li>
</ol>
<p>以下举例进行说明:<br>首先建立一个<code>file1.txt</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">aa</span><br><span class="line">bb</span><br><span class="line">cc</span><br><span class="line">dd</span><br><span class="line">ee</span><br><span class="line">ff</span><br><span class="line">gg</span><br></pre></td></tr></table></figure>
<p>随后建立一个<code>file2.txt</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">aa</span><br><span class="line">bb</span><br><span class="line">cc</span><br><span class="line">zz</span><br><span class="line">dd</span><br><span class="line">ee</span><br><span class="line">ff</span><br><span class="line">gg</span><br></pre></td></tr></table></figure>
<p>使用命令:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ diff file1.txt file2.txt</span><br></pre></td></tr></table></figure>
<p>可以看到输出:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">3a4</span><br><span class="line">&gt; zz</span><br></pre></td></tr></table></figure>
<p>第一行<code>3a4</code>表示变化在第一个文件的第3行，变化的模式是增加(<code>a</code>)的内容，而<code>a</code>后面的4表示变动的内容发生在第二个文件的第4行,增加了<code>&gt;</code>内容<code>zz</code>。</p>
<p>换一个理解方法，<code>3a4</code>中间的<code>a</code>表示了模式，而过了第一个文件第3行以及第二个文件的第4行之后，内容又开始匹配了起来。</p>
<p>修改<code>file2.txt</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">aa</span><br><span class="line">bb</span><br><span class="line">zz</span><br><span class="line">dd</span><br><span class="line">ee</span><br><span class="line">ff</span><br><span class="line">gg</span><br></pre></td></tr></table></figure>
<p>这时候也执行相同的命令，得到:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3c3</span><br><span class="line">&lt; cc</span><br><span class="line">---</span><br><span class="line">&gt; zz</span><br></pre></td></tr></table></figure>
<p>第一行<code>3c3</code>表示内容发生在第一个文件的第3行，变化的模式是更改(<code>c</code>)内容，<code>c</code>后面的3表示变化的内容在第二个文件的第3行，细节是分为两部分，<code>---</code>虚线上方是原来的文件变化，原来的<code>cc</code>出去了(<code>&lt;</code>),而<code>zz</code>进来了(<code>&gt;</code>)。</p>
<p>同样换一个理解方法，<code>3c3</code>中间的<code>c</code>表示了模式，而过了第一个文件第3行以及第二个文件的第3行之后，内容又开始匹配了起来。</p>
<p>再次修改<code>file2.txt</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">aa</span><br><span class="line">bb</span><br><span class="line">dd</span><br><span class="line">ee</span><br><span class="line">ff</span><br><span class="line">gg</span><br></pre></td></tr></table></figure>
<p>执行相同的<code>diff</code>命令:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">3d2</span><br><span class="line">&lt; cc</span><br></pre></td></tr></table></figure>
<p>第一行<code>3d2</code>表示内容发生在第一个文件的第3行，变化的模式是删除(<code>d</code>)内容，<code>d</code>后面的3表示变化的内容在第二个文件的第3行，原来的<code>cc</code>被删除了(<code>&lt;</code>)。</p>
<p>同样，<code>3d2</code>中间的<code>d</code>表示了模式，而过了第一个文件第3行以及第二个文件的第2行之后，内容又开始匹配了起来。</p>
<h2 id="并排输出模式"><a href="#并排输出模式" class="headerlink" title="并排输出模式"></a>并排输出模式</h2><p>并排输出模式提供了对比源文件同行时的情况。</p>
<p><code>file1.txt</code>内容:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">aa</span><br><span class="line">bb</span><br><span class="line">cc</span><br><span class="line">dd</span><br><span class="line">ee</span><br><span class="line">ff</span><br><span class="line">gg</span><br><span class="line">hh</span><br></pre></td></tr></table></figure>
<p><code>file2.txt</code>内容:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">aa</span><br><span class="line">bb</span><br><span class="line">cc</span><br><span class="line">66</span><br><span class="line">99</span><br><span class="line">99</span><br><span class="line">dd</span><br><span class="line">ez</span><br><span class="line">ff</span><br><span class="line">gg</span><br></pre></td></tr></table></figure>
<p>执行命令:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ diff file1.txt file2.txt -y</span><br></pre></td></tr></table></figure>
<p>得到结果:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">aa								aa</span><br><span class="line">bb								bb</span><br><span class="line">cc								cc</span><br><span class="line">						      &gt;	66</span><br><span class="line">						      &gt;	99</span><br><span class="line">						      &gt;	99</span><br><span class="line">dd								dd</span><br><span class="line">ee						      |	ez</span><br><span class="line">ff								ff</span><br><span class="line">gg								gg</span><br><span class="line">hh						      &lt;</span><br></pre></td></tr></table></figure>
<p>这个模式下的输出就比较直观了，可以看到4-6行<code>file1.txt</code>由不存在变成<code>file2.txt</code>新增的三行，而第8行发生了改变，第12行的内容被删除了。</p>
<h2 id="上下文模式"><a href="#上下文模式" class="headerlink" title="上下文模式"></a>上下文模式</h2><p>还是上述的<code>file1.txt</code>和<code>file2.txt</code>，执行:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ diff -c file1.txt file2.txt</span><br></pre></td></tr></table></figure>
<p>得到:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">*** file1.txt	2017-11-18 10:27:50.036977294 +0800</span><br><span class="line">--- file2.txt	2017-11-18 10:27:58.026110636 +0800</span><br><span class="line">***************</span><br><span class="line">*** 1,8 ****</span><br><span class="line">  aa</span><br><span class="line">  bb</span><br><span class="line">  cc</span><br><span class="line">  dd</span><br><span class="line">! ee</span><br><span class="line">  ff</span><br><span class="line">  gg</span><br><span class="line">- hh</span><br><span class="line">--- 1,10 ----</span><br><span class="line">  aa</span><br><span class="line">  bb</span><br><span class="line">  cc</span><br><span class="line">+ 66</span><br><span class="line">+ 99</span><br><span class="line">+ 99</span><br><span class="line">  dd</span><br><span class="line">! ez</span><br><span class="line">  ff</span><br><span class="line">  gg</span><br></pre></td></tr></table></figure>
<p>这个<code>-c</code>就是指定上下文<code>context</code>的参数，这里由星号包围的数字表示原文件中的1到8行的内容显示，具体有第5行更改(<code>！</code>)以及第8行的删除(<code>-</code>)动作;然后由减号包围的数字表示变动内容发生在第二个文件的1到10行中，具体是新增了4到6行(<code>+</code>)以及第8行的更改(<code>！</code>)动作。</p>
<h2 id="统一模式"><a href="#统一模式" class="headerlink" title="统一模式"></a>统一模式</h2><p>执行:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ diff -u file1.txt file2.txt</span><br></pre></td></tr></table></figure>
<p>得到:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">--- file1.txt	2017-11-18 10:27:50.036977294 +0800</span><br><span class="line">+++ file2.txt	2017-11-18 10:27:58.026110636 +0800</span><br><span class="line">@@ -1,8 +1,10 @@</span><br><span class="line"> aa</span><br><span class="line"> bb</span><br><span class="line"> cc</span><br><span class="line">+66</span><br><span class="line">+99</span><br><span class="line">+99</span><br><span class="line"> dd</span><br><span class="line">-ee</span><br><span class="line">+ez</span><br><span class="line"> ff</span><br><span class="line"> gg</span><br><span class="line">-hh</span><br></pre></td></tr></table></figure>
<p>统一模式是把上下文模式分开显示前后文件合并在了一起，<code>@@</code>中的<code>-1,8</code>表示第一个文件中的1到8行，<code>+1,10</code>表示第二个文件的1到10行，随后显示具体的变更内容，注意<code>-ee</code>行和<code>+ez</code>行是更改操作。</p>
<p><code>diff</code>命令也可以用于比较文件夹的不同。</p>
<h2 id="产生补丁以及打补丁"><a href="#产生补丁以及打补丁" class="headerlink" title="产生补丁以及打补丁"></a>产生补丁以及打补丁</h2><p>使用命令:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ diff -ruN file1.txt file2.txt &gt; patch1_2.patch</span><br></pre></td></tr></table></figure>
<p>产生补丁文件，随后用<code>cat</code>命令可以查看补丁的内容:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">--- file1.txt	2017-11-18 10:27:50.036977294 +0800</span><br><span class="line">+++ file2.txt	2017-11-18 10:27:58.026110636 +0800</span><br><span class="line">@@ -1,8 +1,10 @@</span><br><span class="line"> aa</span><br><span class="line"> bb</span><br><span class="line"> cc</span><br><span class="line">+66</span><br><span class="line">+99</span><br><span class="line">+99</span><br><span class="line"> dd</span><br><span class="line">-ee</span><br><span class="line">+ez</span><br><span class="line"> ff</span><br><span class="line"> gg</span><br><span class="line">-hh</span><br></pre></td></tr></table></figure>
<p>完成对<code>file1.txt</code>的打补丁操作:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ patch file1.txt patch1_2.patch</span><br></pre></td></tr></table></figure>
<p><code>file1.txt</code>的内容就会在打了补丁之后与<code>file2.txt</code>一致。</p>
<p>以上是<code>diff</code>命令的简单介绍以及打补丁操作。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://cfwloader.github.io/2017/11/17/diff%E5%91%BD%E4%BB%A4%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" data-id="clximfz6t002c7kkvfds8ghdb" data-title="diff命令学习笔记" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux%E5%91%BD%E4%BB%A4/" rel="tag">Linux命令</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag">学习笔记</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-JavaFX-fxml-快速搭建入门" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/11/08/JavaFX-fxml-%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E5%85%A5%E9%97%A8/" class="article-date">
  <time class="dt-published" datetime="2017-11-08T09:13:41.000Z" itemprop="datePublished">2017-11-08</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Java%E6%8A%80%E6%9C%AF/">Java技术</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/11/08/JavaFX-fxml-%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E5%85%A5%E9%97%A8/">JavaFX fxml 快速搭建入门</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>之前一直使用命令行或者Web技术当作用户交互界面的方式，而且刚开始学习编程的时候前人的经验都挺排斥图形界面编程的，以致于自己除了用Web页面方式之外，再也没有别的图形化编程经验。因为最近有些需要，语言要求是Java，在网上浏览之后，决定采用<code>JavaFX</code>而不是<code>Swing</code>或者<code>awt</code>。事实上，也有可能因为笔者Web项目的经验，而这些框架是基于MVC思想的，所以上手很快，就是得花点时间熟悉提供的工具特性。</p>
<h2 id="环境支持"><a href="#环境支持" class="headerlink" title="环境支持"></a>环境支持</h2><ol>
<li>JDK 1.8</li>
</ol>
<p>笔者用的IDE是JetBrain IDEA Ultimate 2017.1，所以教程也是依据这个IDE提供的功能进行。</p>
<h2 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h2><p>打开IDEA，创建项目，在如图左侧选择<code>JavaFX</code>，一直下一步，项目名一如既往为<code>test</code>:<br><img src="/2017/11/08/JavaFX-fxml-%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E5%85%A5%E9%97%A8/start_project.jpeg"></p>
<p>然后IDEA就会根据模板给我们创建好项目:<br><img src="/2017/11/08/JavaFX-fxml-%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E5%85%A5%E9%97%A8/created_directory.jpeg"></p>
<p>其中，<code>src</code>源码目录下会有一个<code>sample</code>的子目录，这个子目录在将来的工程开发即为包的名字，这个细节是后面的事了。<code>sample</code>目录下有三个文件:</p>
<ol>
<li><code>Controller.java</code>，上面提到过，这些框架是基于<code>MVC</code>思想的，自然而然这个类就是项目的控制器了。当然也跟一般的web项目区别不大， JavaFX项目可以存在多个控制器。但是因为笔者不清楚JavaFX下是否有类似<code>Spring</code>这类<code>IOC</code>框架，所以控制器的实例化就需要手动操作了。</li>
<li><code>Main.java</code>，因为不是web项目，没有容器，所以JavaFX与一般项目一样，需要一个程序的入口，而这里的Main类就承担了这个责任。而且当存在启动参数设置时，尤其是需要传递到应用中，Main类则又承担了应用参数初始化的责任，这些系列将在后面演示。</li>
<li><code>sample.fxml</code>，这个就是GUI布局的文件，跟html有一些相似，却又不同，JavaFX指出两种建立GUI的方式，一种是在代码里面用代码的方式初始化GUI的布局，另一种就是用fxml的文件初始化布局。</li>
</ol>
<h2 id="FXML界面布局"><a href="#FXML界面布局" class="headerlink" title="FXML界面布局"></a>FXML界面布局</h2><p>这里介绍的是用fxml方式初始化界面布局，所谓的与html不同，是因为html提供了一些很直观的方式，例如当你放置一个<code>tr</code>在一个<code>tr</code>下面的时候，在没有<code>css</code>文件针对布局的时候，呈现出来的<code>tr</code>就一定是在<code>tr</code>下面，即编码的布局与显示的布局绑定了。在IDEA模板中，fxml里面的第一层是一个<code>GridPane</code>，将图形界面分为一个一个的格子。IDEA初始化的<code>sample.fxml</code>内容:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?import javafx.geometry.Insets?&gt;</span><br><span class="line">&lt;?import javafx.scene.layout.GridPane?&gt;</span><br><span class="line"></span><br><span class="line">&lt;?import javafx.scene.control.Button?&gt;</span><br><span class="line">&lt;?import javafx.scene.control.Label?&gt;</span><br><span class="line">&lt;GridPane fx:controller="sample.Controller"</span><br><span class="line">          xmlns:fx="http://javafx.com/fxml" alignment="center" hgap="10" vgap="10"&gt;</span><br><span class="line">&lt;/GridPane&gt;</span><br></pre></td></tr></table></figure>
<p>既然是快速入门，先运行一遍项目，可以看到一个空白的窗口:<br><img src="/2017/11/08/JavaFX-fxml-%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E5%85%A5%E9%97%A8/window1.jpeg"></p>
<p>开始修改图形界面，以加入一个<code>TextField</code>为例，试试简单地在<code>GridPane</code>里面添加一句<code>TextField</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?import javafx.geometry.Insets?&gt;</span><br><span class="line">&lt;?import javafx.scene.layout.GridPane?&gt;</span><br><span class="line"></span><br><span class="line">&lt;?import javafx.scene.control.Button?&gt;</span><br><span class="line">&lt;?import javafx.scene.control.Label?&gt;</span><br><span class="line">&lt;?import javafx.scene.control.TextField?&gt;</span><br><span class="line">&lt;GridPane fx:controller="sample.Controller"</span><br><span class="line">          xmlns:fx="http://javafx.com/fxml" alignment="center" hgap="10" vgap="10"&gt;</span><br><span class="line">    &lt;TextField/&gt;</span><br><span class="line">&lt;/GridPane&gt;</span><br></pre></td></tr></table></figure>
<p>运行得到:<br><img src="/2017/11/08/JavaFX-fxml-%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E5%85%A5%E9%97%A8/window2.jpeg"></p>
<p>似乎没有什么问题，接下来尝试在这个<code>TextField</code>的左边加个显示内容为<code>Input:</code>的<code>Label</code>以及一个Button，注意这时候就需要给这个<code>GridPane</code>内的元素添加<code>GridPane.rowIndex</code>和<code>GridPane.columnIndex</code>属性来确定元素在里面的位置了，不然笔者猜测可能自动将添加的元素默认为<code>GridPane.rowIndex=0</code>和<code>GridPane.columnIndex=0</code>然后按照出现的顺序将前面的元素覆盖了。修改后的<code>sample.fxml</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?import javafx.geometry.Insets?&gt;</span><br><span class="line">&lt;?import javafx.scene.layout.GridPane?&gt;</span><br><span class="line"></span><br><span class="line">&lt;?import javafx.scene.control.Button?&gt;</span><br><span class="line">&lt;?import javafx.scene.control.Label?&gt;</span><br><span class="line">&lt;?import javafx.scene.control.TextField?&gt;</span><br><span class="line">&lt;GridPane fx:controller="sample.Controller"</span><br><span class="line">          xmlns:fx="http://javafx.com/fxml" alignment="center" hgap="10" vgap="10"&gt;</span><br><span class="line">    &lt;Label text="Input:" GridPane.rowIndex="0" GridPane.columnIndex="0"/&gt;</span><br><span class="line">    &lt;TextField GridPane.rowIndex="0" GridPane.columnIndex="1"/&gt;</span><br><span class="line">    &lt;Button GridPane.rowIndex="1" GridPane.columnIndex="1" text="Button"/&gt;</span><br><span class="line">&lt;/GridPane&gt;</span><br></pre></td></tr></table></figure>
<p>然后就可以得到一个简易的界面:<br><img src="/2017/11/08/JavaFX-fxml-%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E5%85%A5%E9%97%A8/window3.jpg"></p>
<p>由于本文目的是快速构建一个GUI，例如想将两个元素放置入一个<code>GridPane</code>中(使用<code>VBox</code>)等涉及的更多的布局需求情况暂不在此展开讨论。</p>
<h2 id="获取图形界面元素中的值"><a href="#获取图形界面元素中的值" class="headerlink" title="获取图形界面元素中的值"></a>获取图形界面元素中的值</h2><p>前面的步骤也只是建立了一个简单的图形界面，但是程序的后台无法获得图形中的界面发生的事件以及元素中的值。这一步将介绍如何获取窗口中<code>Button</code>的点击事件，以及获得<code>TextField</code>中的值。</p>
<p>首先打开<code>Controller.java</code>，IDEA给我们创建了空的内容:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">package sample;</span><br><span class="line"></span><br><span class="line">public class Controller {</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>因为我们是想获取<code>TextField</code>的内容的值，以及<code>Button</code>的点击事件，将代码修改如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">package sample;</span><br><span class="line"></span><br><span class="line">import javafx.event.ActionEvent;</span><br><span class="line">import javafx.fxml.FXML;</span><br><span class="line">import javafx.scene.control.TextField;</span><br><span class="line"></span><br><span class="line">public class Controller {</span><br><span class="line"></span><br><span class="line">    @FXML</span><br><span class="line">    private TextField textField;</span><br><span class="line"></span><br><span class="line">    @FXML</span><br><span class="line">    public void handleButtonAction(ActionEvent actionEvent)</span><br><span class="line">    {</span><br><span class="line">        System.out.println(textField.getText());</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>有的教程里面会提示<code>Controller</code>需要实现<code>javafx.fxml.Initializable</code>接口才能正常使用<code>Controller</code>，因为在本过程中没有出现该情况，因而简做提示而跳过。</p>
<p>注意<code>textField</code>这个变量名，以及在<code>Controller</code>中成员以及函数添加的<code>@FXML</code>注解，都是为了让他们能被感知到。接着修改<code>sample.fxml</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?import javafx.geometry.Insets?&gt;</span><br><span class="line">&lt;?import javafx.scene.layout.GridPane?&gt;</span><br><span class="line"></span><br><span class="line">&lt;?import javafx.scene.control.Button?&gt;</span><br><span class="line">&lt;?import javafx.scene.control.Label?&gt;</span><br><span class="line">&lt;?import javafx.scene.control.TextField?&gt;</span><br><span class="line">&lt;GridPane fx:controller="sample.Controller"</span><br><span class="line">          xmlns:fx="http://javafx.com/fxml" alignment="center" hgap="10" vgap="10"&gt;</span><br><span class="line">    &lt;Label text="Input:" GridPane.rowIndex="0" GridPane.columnIndex="0"/&gt;</span><br><span class="line">    &lt;TextField GridPane.rowIndex="0" GridPane.columnIndex="1" fx:id="textField"/&gt;</span><br><span class="line">    &lt;Button GridPane.rowIndex="1" GridPane.columnIndex="1" text="Button" onAction="#handleButtonAction"/&gt;</span><br><span class="line">&lt;/GridPane&gt;</span><br></pre></td></tr></table></figure>
<p>注意到<code>GridPane</code>被IDEA模板创建的时候带有了一个<code>fx:controller="sample.Controller"</code>，即该界面与<code>Controller</code>绑定，然后在<code>TextField</code>添加的<code>fx:id="textField"</code>即代表这个<code>TextField</code>与<code>Controller</code>中的<code>textField</code>成员绑定。而<code>Button</code>则添加了一个<code>onAction="#handleButtonAction"</code>代表这个Button在发生点击事件的时候调用<code>Controller</code>中的<code>handleButtonAction</code>方法。</p>
<p>运行程序，在输入框中输入一些测试用的数据:<br><img src="/2017/11/08/JavaFX-fxml-%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E5%85%A5%E9%97%A8/window4.jpg"></p>
<p>然后查看控制台输出:<br><img src="/2017/11/08/JavaFX-fxml-%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E5%85%A5%E9%97%A8/output1.jpg"></p>
<p>证明<code>Controller</code>的成员成功地与图形界面中的元素成功对应。</p>
<h2 id="设置传递非界面参数予Controller"><a href="#设置传递非界面参数予Controller" class="headerlink" title="设置传递非界面参数予Controller"></a>设置传递非界面参数予Controller</h2><p>前面介绍的基础内容已经足够一般的交互情况了，但是之前笔者涉及到读取程序启动参数并传入到<code>Controller</code>中，而且这个也可能涉及到程序的全局变量初始化问题，因而介绍一下。</p>
<p>假设我们需要设置<code>Controller.textField</code>成员初始显示的值，而且是从程序启动参数中获取，我们在<code>Controller</code>中添加一个<code>String fromCmd</code>并设置一个对应的<code>setter</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">package sample;</span><br><span class="line"></span><br><span class="line">import javafx.event.ActionEvent;</span><br><span class="line">import javafx.fxml.FXML;</span><br><span class="line">import javafx.scene.control.TextField;</span><br><span class="line"></span><br><span class="line">public class Controller {</span><br><span class="line"></span><br><span class="line">    @FXML</span><br><span class="line">    private TextField textField;</span><br><span class="line"></span><br><span class="line">    private String fromCmd;</span><br><span class="line"></span><br><span class="line">    @FXML</span><br><span class="line">    public void handleButtonAction(ActionEvent actionEvent)</span><br><span class="line">    {</span><br><span class="line">        System.out.println(textField.getText());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    public void setFromCmd(String fromCmd) {</span><br><span class="line">        this.fromCmd = fromCmd;</span><br><span class="line"></span><br><span class="line">        textField.setText(fromCmd);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>注意在此类类实例不知道什么时候初始化的情况里，不要用构造函数的方法初始化一些变量，之前尝试了初始化<code>TableView</code>并且在初始化中设置一些值，然而因为不清楚复杂的构造过程，无法成功构建。</p>
<p>原本的<code>Main.java</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">package sample;</span><br><span class="line"></span><br><span class="line">import javafx.application.Application;</span><br><span class="line">import javafx.fxml.FXMLLoader;</span><br><span class="line">import javafx.scene.Parent;</span><br><span class="line">import javafx.scene.Scene;</span><br><span class="line">import javafx.stage.Stage;</span><br><span class="line"></span><br><span class="line">public class Main extends Application {</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void start(Stage primaryStage) throws Exception{</span><br><span class="line">        Parent root = FXMLLoader.load(getClass().getResource("sample.fxml"));</span><br><span class="line">        primaryStage.setTitle("Hello World");</span><br><span class="line">        primaryStage.setScene(new Scene(root, 300, 275));</span><br><span class="line">        primaryStage.show();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line">        launch(args);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>修改为:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">package sample;</span><br><span class="line"></span><br><span class="line">import javafx.application.Application;</span><br><span class="line">import javafx.fxml.FXMLLoader;</span><br><span class="line">import javafx.scene.Parent;</span><br><span class="line">import javafx.scene.Scene;</span><br><span class="line">import javafx.stage.Stage;</span><br><span class="line"></span><br><span class="line">public class Main extends Application {</span><br><span class="line"></span><br><span class="line">    private static String[] appArgs;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void start(Stage primaryStage) throws Exception{</span><br><span class="line"></span><br><span class="line">        FXMLLoader fxmlLoader = new FXMLLoader(getClass().getResource("sample.fxml"));</span><br><span class="line"></span><br><span class="line">        Parent root = fxmlLoader.load();</span><br><span class="line"></span><br><span class="line">        Controller controller = fxmlLoader.getController();</span><br><span class="line"></span><br><span class="line">        if(appArgs.length &gt; 0)</span><br><span class="line">        {</span><br><span class="line">            controller.setFromCmd(appArgs[0]);</span><br><span class="line">        }</span><br><span class="line">        else</span><br><span class="line">        {</span><br><span class="line">            controller.setFromCmd("default");</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        primaryStage.setTitle("Hello World");</span><br><span class="line">        primaryStage.setScene(new Scene(root, 300, 275));</span><br><span class="line">        primaryStage.show();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) {</span><br><span class="line"></span><br><span class="line">        appArgs = args;</span><br><span class="line"></span><br><span class="line">        launch(args);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>这样的话我们就可以获取到程序启动参数并输入到<code>Controller</code>当中，当使用者提供启动参数的时候则设置到<code>Controller.textField</code>中，否则设置其值为<code>default</code>。</p>
<p>运行结果，不输入参数:<br><img src="/2017/11/08/JavaFX-fxml-%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E5%85%A5%E9%97%A8/window5.jpg"></p>
<p>在IDEA中设置程序启动参数:<br><img src="/2017/11/08/JavaFX-fxml-%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E5%85%A5%E9%97%A8/idea-setting1.jpg"></p>
<p>加入参数后的运行结果:<br><img src="/2017/11/08/JavaFX-fxml-%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E5%85%A5%E9%97%A8/window6.jpg"></p>
<p>从前面的<code>Main.java</code>获取<code>Controller</code>的过程来看，<code>Controller</code>的初始化是交给了<code>FXMLLoader</code>的，我们无法得知其初始化的时机，而且也之能够从<code>FXMLLoader</code>获取得帮定的控制器。</p>
<p>至此，一个基于fxml的快速构建应用介绍完毕。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://cfwloader.github.io/2017/11/08/JavaFX-fxml-%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E5%85%A5%E9%97%A8/" data-id="clximfz6p001k7kkvenos2yxj" data-title="JavaFX fxml 快速搭建入门" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/GUI/" rel="tag">GUI</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaFX/" rel="tag">JavaFX</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fxml/" rel="tag">fxml</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-RHEL5-4下配置Tomcat-Apache" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/11/02/RHEL5-4%E4%B8%8B%E9%85%8D%E7%BD%AETomcat-Apache/" class="article-date">
  <time class="dt-published" datetime="2017-11-02T01:52:44.000Z" itemprop="datePublished">2017-11-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Linux/">Linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/11/02/RHEL5-4%E4%B8%8B%E9%85%8D%E7%BD%AETomcat-Apache/">RHEL5.4下配置Tomcat+Apache</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>笔者一直为一个项目进行后期开发以及维护，因为基础服务提供者的质量太差，导致最近作为服务器的虚拟机又崩溃了。而且崩溃最严重的地方是虚拟存储服务，以致于现今需要在一台新的虚拟服务器上重新部署项目。因为上一年也经历过该情况，所以将部署过程写成博客，以防再次发生时没有部署文档参考。</p>
<h2 id="环境支持"><a href="#环境支持" class="headerlink" title="环境支持"></a>环境支持</h2><ol>
<li>RHEL 5.4</li>
<li>gcc</li>
<li>ssh，Windows下可选择XShell。</li>
</ol>
<h2 id="所需工具"><a href="#所需工具" class="headerlink" title="所需工具"></a>所需工具</h2><ol>
<li>MySQL，笔者部署用祖传的<code>MySQL-5.6.25-1.rhel5.x86_64.rpm-bundle.tar</code></li>
<li>JDK-1.7.0_21</li>
<li>Apache Tomcat 7.0.62</li>
<li><a target="_blank" rel="noopener" href="http://mirror.bit.edu.cn/apache//httpd/httpd-2.2.34.tar.gz">Apache 2.2.34</a></li>
<li><a target="_blank" rel="noopener" href="http://archive.apache.org/dist/activemq/apache-activemq/5.7.0/apache-activemq-5.7.0-bin.tar.gz">Apache Active MQ 5.7.0</a></li>
<li>Tomcat Connector - <a target="_blank" rel="noopener" href="http://mirrors.tuna.tsinghua.edu.cn/apache/tomcat/tomcat-connectors/jk/tomcat-connectors-1.2.42-src.tar.gz">JK-1.2.42</a></li>
</ol>
<h3 id="工具说明"><a href="#工具说明" class="headerlink" title="工具说明"></a>工具说明</h3><p>因为这是一个实际部署的项目，所以用的工具都是一直传下来的，不能随意更换，不然很有可能导致服务器无法正常运行项目。例如笔者最近部署贪方便，使用了JDK1.8编译项目，就算能够通过设置参数让JDK1.8编译等级为1.7,但是始终无法编译成功。以下针对使用的工具进行简单说明:</p>
<ol>
<li>这些工具版本最好是固定这个组合，别的版本组合不能确保项目能够成功部署运行，有些工具可能太老了，已经不提供官方下载了，只能通过别的方法获取，或者尝试使用近似的版本。</li>
<li>笔者也想全程使用ssh远程控制服务器，但是因为是通过堡垒机登录的服务器，所以涉及文件传输的时候使用<code>scp</code>等命令是无法正常工作的，而祖传下来的方法是在Windows下使用X-Shell登录服务器，而在服务器使用<code>rz -be</code>命令接收文件，<code>sz ${文件路径}</code>将文件发送到本地机器上。</li>
<li>MySQL，JDK，Tomcat，Apache是常用的工具，这里不加以说明。</li>
<li>Apache Active MQ，百度上是介绍是用来集群进行消息传递的，但是在该项目的主要提供邮件发送服务。</li>
<li>Tomcat Connector，用于提供Apache的负载均衡时，Apache与Tomcat的连接。</li>
</ol>
<h3 id="初始准备"><a href="#初始准备" class="headerlink" title="初始准备"></a>初始准备</h3><p>笔者将所需的工具先传输到了<code>/home/trans/recv</code>目录下，其中包含打包好的项目，名为<code>Demo.war</code>。<br>虚拟服务器上只有一个<code>root</code>账户，注意操作全程是在<code>root</code>权限下进行。</p>
<h2 id="安装MySQL"><a href="#安装MySQL" class="headerlink" title="安装MySQL"></a>安装MySQL</h2><p>在工具所在的目录下，执行:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">mkdir</span> mysql-bundle</span><br><span class="line">$ tar xvf MySQL-5.6.25-1.rhel5.x86_64.rpm-bundle.tar -C ./mysql-bundle</span><br><span class="line">$ <span class="built_in">cd</span> mysql-bundle</span><br></pre></td></tr></table></figure>
<p>解压文件并进入目录。</p>
<p>执行命令:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ rpm -ivh MySQL-server-5.6.25-1.rhel5.x86_64.rpm --nodeps --force</span><br><span class="line">$ rpm -ivh MySQL-client-5.6.25-1.rhel5.x86_64.rpm --nodeps --force</span><br></pre></td></tr></table></figure>
<p>安装MySQL服务器以及客户端，里面加了<code>--force</code>参数是为了跳过GPG keys检测，不然无法成功安装。</p>
<p>该版本的MySQL安装之后，<code>root</code>的默认密码不为空，执行:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cat</span> ~/.mysql_secret</span><br></pre></td></tr></table></figure>
<p>查看文本，获取初始密码。</p>
<p>设置MySQL <code>root</code>账户的初始密码:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mysqladmin -u root -p password <span class="variable">${新密码}</span></span><br></pre></td></tr></table></figure>
<p>之后会询问之前的密码，输入在.mysql_secret看到的密码即可修改成功。</p>
<p>进入mysql建立项目所需的数据库和表，注意建库的时候使用:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ CREATE DATABASE <span class="string">'${库名}'</span> DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;</span><br></pre></td></tr></table></figure>
<p>指定库的编码为<code>UTF-8</code>，或者根据项目需要更改编码。</p>
<p>至此，MySQL的安装以及初始配置完成。</p>
<h2 id="安装JDK"><a href="#安装JDK" class="headerlink" title="安装JDK"></a>安装JDK</h2><p>卸载系统自带的open JDK：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rpm -qa | grep gcj</span><br></pre></td></tr></table></figure>
<p>看到的一行同时具有<code>java</code>和<code>gcj</code>字样的，就是卸载目标使用<code>yum remove</code>命令卸载即可。<br>系统中也有可能存在其他的jdk，同样卸载即可。</p>
<p>展开JDK压缩包，并指定到:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ tar zxvf jdk-7u21-linux-x64.gz -C /usr/local/Java/</span><br></pre></td></tr></table></figure>

<p>添加<code>Java</code>的系统变量:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vim /etc/profile</span><br></pre></td></tr></table></figure>

<p>添加到文件尾:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/local/Java/jdk1.7.0_21</span><br><span class="line">export CLASSPATH=.:$CLASSPATH:$JAVA_HOME/lib:$JAVA_HOME/jre/lib</span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin:$JAVA_HOME/jre/bin</span><br></pre></td></tr></table></figure>

<p>可以:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>
<p>更新一下系统变量。</p>
<h2 id="安装Apache"><a href="#安装Apache" class="headerlink" title="安装Apache"></a>安装Apache</h2><p>因为是一个实际部署的站点，故首先需要对本机的路由进行一些修改:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vim etc/hosts</span><br></pre></td></tr></table></figure>
<p>内容修改为:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">127.0.0.1   ${站点名}</span><br></pre></td></tr></table></figure>
<p>后推出编辑器。</p>
<p>展开压缩包并进入目录:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ tar zxvf httpd-2.2.34.tar.gz</span><br><span class="line">$ <span class="built_in">cd</span> httpd-2.2.34</span><br></pre></td></tr></table></figure>

<p>创建安装目录并使用命令安装:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">mkdir</span> /usr/local/apache</span><br><span class="line">$ ./configure--prefix=/usr/local/apache --enable-so --enable-proxy --enable-proxy_http=shared --enable-module=so --enable-mods-shared=all --enable-proxy-ajp=shared  --enable-proxy-balancer -with-mpm=worker</span><br><span class="line">$ make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
<p>进入漫长的等待编译过程，中间可能会碰上<code>apr</code>、<code>apr-util</code>、<code>pcre</code>缺失，在这该虚拟机提供的环境暂不缺失，故在这里不展开细说。</p>
<p>安装完毕后开始配置Apache。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /usr/local/apache/conf</span><br><span class="line">$ vim httpd.conf</span><br></pre></td></tr></table></figure>
<p>首先修改<code>ServerName</code>行为:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ServerName ${站点名}:${端口号}</span><br></pre></td></tr></table></figure>
<p>确定<code>DocumentRoot</code>为:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DocumentRoot "/usr/local/apache/htdocs"</span><br></pre></td></tr></table></figure>

<p>将以下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Include conf/extra/httpd-mpm.conf</span><br><span class="line">Include conf/extra/httpd-vhosts.conf</span><br><span class="line">Include conf/extra/httpd-default.conf</span><br></pre></td></tr></table></figure>
<p>的注释去除，启用这些配置。</p>
<p>修改<code>extra/httpd-vhost.conf</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vim extra/httpd-vhost.conf</span><br></pre></td></tr></table></figure>
<p>内容为:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;VirtualHost *:80&gt;</span><br><span class="line">    DocumentRoot "/usr/local/apache/htdocs"</span><br><span class="line">    ServerName ${站点名}</span><br><span class="line">   &lt;Directory "/usr/local/apache/htdocs"&gt;</span><br><span class="line">        Options Indexes FollowSymLinks</span><br><span class="line">        AllowOverride None</span><br><span class="line">   &lt;/Directory&gt;</span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>保存退出。</p>
<p>之后可以使用:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ /usr/local/apache/bin/apachectl start</span><br></pre></td></tr></table></figure>
<p>启动httpd，在别的机器上访问该站点，可以看到返回的网页，其中有字符串类似于”Hello world!”，证明站点上的apache部署成功。<br>使用命令:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ /usr/local/apache/bin/apachectl stop</span><br></pre></td></tr></table></figure>
<p>停止apache服务，进行Tomcat的安装配置。</p>
<h2 id="安装Tomcat"><a href="#安装Tomcat" class="headerlink" title="安装Tomcat"></a>安装Tomcat</h2><p>回到存放工具压缩包的目录，执行:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ tar zxvf apache-tomcat-7.0.62.tar.gz -C /opt/</span><br><span class="line">$ <span class="built_in">cd</span> /opt/apache-tomcat-7.0.62/</span><br></pre></td></tr></table></figure>
<p>解压并开始配置tomcat。<br>修改<code>conf/catalina.sh</code>，在文件配置信息开始段添加:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">JAVA_OPTS="-Xms1024m -Xmx4096m -XX:PermSize=256m -XX:MaxPermSize=512m"</span><br><span class="line">export TOMCAT_HOME=/opt/apache-tomcat-7.0.62</span><br><span class="line">export CATALINA_HOME=/opt/apache-tomcat-7.0.62</span><br><span class="line">export JRE_HOME=/usr/local/Java/jdk1.7.0_21/jre</span><br><span class="line">export JAVA_HOME=/usr/local/Java/jdk1.7.0_21</span><br></pre></td></tr></table></figure>
<p>一个是告知tomcat，该系统的jdk的位置;第二个功能，是配置JVM的启动参数，上一年重新配置该服务器的时候，一切配置正常，从外部访问该站点却死活返回不了完整的页面，经过两三天的折腾，终于发现是tomcat启动JVM的默认内存太小，以至于部署项目以及初始化tomcat过程虚拟机的内存就爆满了，不断地触发GC，使用<code>top</code>命令可以看到虚拟机的CPU占用率极高，当时也没有HTTP访问。刚开始从tomcat的log里面找不到明显的异常记录，就把解决问题的方向指向了apache整合tomcat中去，配置JK模块修改了很多个版本都不行。最后还是老师兄厉害，整个部署错误就在tomcat的log的一句<code>Memory Exceeded</code>里面，而不是常见的一大段的异常报告文本段。<br>今年这一次重新部署也类似，不过有了一年的经验，找出了单句严重错误日志，是tomcat在初始化一个监听器的时候缺少了这个类的实现，还有零散的错误，也是之前提到了这个是我用JDK1.8编译项目出的问题，用祖传的JDK1.7-21编译就没问题了。</p>
<p>一般的教程到这里会让启动tomcat下的<code>bin/startup.sh</code>，然后通过本地浏览器参看tomcat是否成功配置，但是我们处于没有图形化界面的服务器中，所以这里笔者假定tomcat是能够正常启动的，或者可以先把apache的根目录设置为<code>/opt/apache-tomcat-7.0.62/webapps</code>，之后从能够使用浏览器的外部机器访问站点，如果能够访问到tomcat的主页的话就没问题了。</p>
<p>将要发布的项目的war复制到tomcat下，执行:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cp</span> /home/trans/recv/Demo.war /opt/apache-tomcat-7.0.62/webapps/</span><br></pre></td></tr></table></figure>

<p>修改<code>conf/server.xml</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vim conf/server.xml</span><br></pre></td></tr></table></figure>
<p>其中有将<code>port</code>值为<code>8080</code>以及<code>8009</code>的<code>Connector</code>配置段修改为:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> &lt;Connector port="8080" protocol="HTTP/1.1" connectionTimeout="20000" redirectPort="8443" useBodyEncodingForURI="true" URIEncoding="UTF-8"/&gt;</span><br><span class="line">			   </span><br><span class="line">&lt;Connector port="8009" protocol="AJP/1.3" redirectPort="8443" useBodyEncodingForURI="true" URIEncoding="UTF-8" protocolHandlerClassName="org.apache.jk.server.jkCoyoteHandler"/&gt;</span><br></pre></td></tr></table></figure>
<p>因为Apache整合tomcat中用的JK模块是用<code>AJP</code>进行通信的，所以<code>8009</code>端口配置要正确，<code>AJP</code>的版本要和稍后配置的<code>workers.properties</code>中的版本一致，这里采用的<code>1.3</code>。<br>继续修改<code>server.xml</code>中的<code>Engine</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Engine name="Catalina" defaultHost="localhost" jvmRoute="tomcat1"&gt;</span><br></pre></td></tr></table></figure>
<p>这里要注意的是<code>jvmRoute</code>的值，这里需要稍后配置的<code>workers.properties</code>中的<code>worker</code>保持一致，否则JK模块无法正常找到该tomcat完成整合。<br>继续修改<code>Host</code>段:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Host name="localhost" appBase="/usr/local/apache/htdocs/Demo" autoDeploy="true" unpackWARS="true" xmlNamespaceAware="false" xmlValidation="false"&gt;</span><br><span class="line">        &lt;Context path="/" docBase="/opt/apache-tomcat-7.0.62/webapps/Demo.war" reloadable="true" debug="0" crossContext="true"/&gt;</span><br><span class="line">&lt;/Host&gt;</span><br></pre></td></tr></table></figure>
<p>这里配置了项目发布到apache中的本地位置，以及项目的存放位置等配置。</p>
<p>其实应该还有集群时的<code>Cluster</code>段的配置，当年老师兄传给我的时候说这段是不需要配的，因为项目根本不是分布式的，虽然apache那边是配置好的，但是机器只有一台，等以后有机会再配置集群的<code>Session</code>问题也不迟。这个项目都已经老年时期了，所以是没可能的了，所以需要配置集群的看官抱歉了，这里没有，只能自行百度了。</p>
<p>至此，tomcat的配置完成。</p>
<h2 id="编译安装JK模块到Apache中"><a href="#编译安装JK模块到Apache中" class="headerlink" title="编译安装JK模块到Apache中"></a>编译安装JK模块到Apache中</h2><p>回到工具包的存放目录，执行:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ tar zxvf tomcat-connectors-1.2.42-src.tar.gz</span><br><span class="line">$ <span class="built_in">cd</span> tomcat-connectors-1.2.42-src/native</span><br></pre></td></tr></table></figure>
<p>解压tomcat connector并进入目录。<br>编译JK模块:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">chmod</span> 755 buildconf.sh</span><br><span class="line">$ ./buildconf.sh</span><br><span class="line">$ ./configure --with-apxs=/usr/local/apache/bin/apxs</span><br><span class="line">$ make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
<p>耐心等待过程的完成,完成后apache的<code>modules</code>目录下会出现一个<code>mod_jk.so</code>的动态库。</p>
<h2 id="Apache整合Tomcat"><a href="#Apache整合Tomcat" class="headerlink" title="Apache整合Tomcat"></a>Apache整合Tomcat</h2><p>继续打开:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vim /usr/local/apache/conf/httpd.conf</span><br></pre></td></tr></table></figure>

<p>在<code>Include</code>段添加一句:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Include conf/mod_jk.conf</span><br></pre></td></tr></table></figure>

<p>在<code>conf</code>目录下新建一个<code>mod_jk.conf</code>文件，添加如下内容:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LoadModule jk_module modules/mod_jk.so</span><br><span class="line">JkWorkersFile conf/workers.properties</span><br></pre></td></tr></table></figure>

<p>在<code>conf</code>目录下新建一个<code>workers.properties</code>文件，添加如下内容:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">workers.java_home=/usr/local/Java/jdk1.7.0_21</span><br><span class="line">ps=/</span><br><span class="line"></span><br><span class="line">worker.list=controller,tomcat1</span><br><span class="line"></span><br><span class="line">#Set properties for tomcat1</span><br><span class="line">worker.tomcat1.type=ajp13  </span><br><span class="line">worker.tomcat1.host=localhost  </span><br><span class="line">worker.tomcat1.port=8009</span><br><span class="line">worker.tomcat1.lbfactor=50  </span><br><span class="line">worker.tomcat1.cachesize=10  </span><br><span class="line">worker.tomcat1.cache_timeout=600  </span><br><span class="line">worker.tomcat1.socket_keepalive=1  </span><br><span class="line">worker.tomcat1.socket_timeout=300</span><br><span class="line"></span><br><span class="line">worker.controller.type=lb</span><br><span class="line">worker.controller.balance_workers=tomcat1</span><br><span class="line">worker.controller.sticky_session=false</span><br></pre></td></tr></table></figure>

<p>随后修改<code>conf/extra/httpd-vhosts.conf</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;VirtualHost *:80&gt;</span><br><span class="line">    DocumentRoot "/usr/local/apache/htdocs/Demo"</span><br><span class="line">    ServerName ${站点名}</span><br><span class="line">   &lt;Directory "/usr/local/apache/htdocs/Demo"&gt;</span><br><span class="line">        Options Indexes FollowSymLinks</span><br><span class="line">        AllowOverride None</span><br><span class="line">   &lt;/Directory&gt;</span><br><span class="line">  JkMount /* tomcat1</span><br><span class="line">  JkMount /*.* tomcat1</span><br><span class="line">&lt;/VirtualHost&gt;</span><br></pre></td></tr></table></figure>

<p>至此，配置已经给好了，剩下的就是启动测试了。</p>
<h2 id="设置tomcat和apache为系统服务"><a href="#设置tomcat和apache为系统服务" class="headerlink" title="设置tomcat和apache为系统服务"></a>设置tomcat和apache为系统服务</h2><p>创建<code>/etc/init.d/tomcat</code>，添加内容:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># !/bin/sh</span><br><span class="line"># tomcat</span><br><span class="line"># chkconfig: 345 63 37</span><br><span class="line"># description: tomcat.</span><br><span class="line"># processname tomcat 7.0</span><br><span class="line"></span><br><span class="line">export JAVA_HOME=/usr/local/Java/jdk1.7.0_21</span><br><span class="line">export CLASSPATH=$JAVA_HOME/lib:$JAVA_HOME/jre/lib</span><br><span class="line">. /etc/rc.d/init.d/functions</span><br><span class="line">. /etc/sysconfig/network</span><br><span class="line">case $1 in</span><br><span class="line">start)</span><br><span class="line">sh /opt/apache-tomcat-7.0.62/bin/startup.sh</span><br><span class="line">;;</span><br><span class="line">stop)</span><br><span class="line">sh /opt/apache-tomcat-7.0.62/bin/shutdown.sh</span><br><span class="line">;;</span><br><span class="line">restart)</span><br><span class="line">sh /opt/apache-tomcat-7.0.62/bin/shutdown.sh</span><br><span class="line">sh /opt/apache-tomcat-7.0.62/bin/startup.sh</span><br><span class="line">;;</span><br><span class="line">esac</span><br><span class="line">exit 0</span><br></pre></td></tr></table></figure>

<p>创建<code>/etc/init.d/tomcat</code>,添加内容:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># !/bin/sh</span><br><span class="line">. /etc/rc.d/init.d/functions</span><br><span class="line">. /etc/sysconfig/network</span><br><span class="line">case $1 in</span><br><span class="line">start)</span><br><span class="line">sh /usr/local/apache/bin/apachectl start</span><br><span class="line">;;</span><br><span class="line">stop)</span><br><span class="line">sh /usr/local/apache/bin/apachectl stop</span><br><span class="line">;;</span><br><span class="line">restart)</span><br><span class="line">sh /usr/local/apache/bin/apachectl restart</span><br><span class="line">;;</span><br><span class="line">esac</span><br><span class="line">exit 0</span><br></pre></td></tr></table></figure>

<p>赋予执行权限:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">chmod</span> a+x /etc/init.d/tomcat /etc/init.d/httpd</span><br></pre></td></tr></table></figure>

<p>让<code>service</code>感知到新的服务:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ service reload</span><br></pre></td></tr></table></figure>

<p>然后就可以用:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ service httpd start</span><br><span class="line">$ service tomcat start</span><br></pre></td></tr></table></figure>
<p>以及<code>restart</code>等选项便捷启动。</p>
<p>老师兄传的是，反复使用上面命令启动httpd以及tomcat，直到<code>/usr/local/apache/htdocs</code>下生成了<code>Demo</code>目录，并且在该目录下有一个<code>ROOT</code>的目录，然后就可以从外部机器访问该站点发布的项目了。</p>
<p>至此，一个Apache整合Tomcat的实战就完成了。</p>
<h2 id="安装ActiveMQ"><a href="#安装ActiveMQ" class="headerlink" title="安装ActiveMQ"></a>安装ActiveMQ</h2><p>因为项目用到了邮件发送，依赖于ActiveMQ的支持。不过这个安装也很简单:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ tar zxvf /home/trans/recv/apache-activemq-5.7.0-bin.tar.gz -C /opt/</span><br><span class="line">$ <span class="built_in">cd</span> /opt/apache-activemq-5.7.0/</span><br><span class="line">$ bin/activemq start</span><br></pre></td></tr></table></figure>
<p>然后基本上就不用管了。</p>
<p>其他还有一些祖传的脚本，用于项目发布，以及上年经过灾害后我写来用于备份数据的脚本，可惜这一次毁得太彻底了，我都懒得再写了，就让这个项目静静地走向生命周期的结束吧。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ol>
<li>在一个真正的部署环境下，之能够查看工具提供的日志了，看日志很重要，而不是像平时的在代码写一句输出到控制台那么简单地捕捉到异常，学会看日志很重要，不然就会重现上一年我死活部署了三天，就是因为没看到那么一小条日志。</li>
<li>备份机制，你要假定灾害随时发生，并且都是最坏情况，幸好上一年有了经历灾害的经历，自己写了一份备份脚本，不然今年的国庆节我也不可能玩得那么放心了。</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://cfwloader.github.io/2017/11/02/RHEL5-4%E4%B8%8B%E9%85%8D%E7%BD%AETomcat-Apache/" data-id="clximfz6r001w7kkvh89y3r95" data-title="RHEL5.4下配置Tomcat+Apache" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Apache/" rel="tag">Apache</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RHEL/" rel="tag">RHEL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Tomcat/" rel="tag">Tomcat</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4/" rel="tag">系统运维</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Fedora-25下开启Sublime-Text-3的中文输入支持" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/11/01/Fedora-25%E4%B8%8B%E5%BC%80%E5%90%AFSublime-Text-3%E7%9A%84%E4%B8%AD%E6%96%87%E8%BE%93%E5%85%A5%E6%94%AF%E6%8C%81/" class="article-date">
  <time class="dt-published" datetime="2017-11-01T01:54:14.000Z" itemprop="datePublished">2017-11-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Linux/">Linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/11/01/Fedora-25%E4%B8%8B%E5%BC%80%E5%90%AFSublime-Text-3%E7%9A%84%E4%B8%AD%E6%96%87%E8%BE%93%E5%85%A5%E6%94%AF%E6%8C%81/">Fedora 25下开启Sublime Text 3的中文输入支持</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>因为之前一直没怎么使用Sublime Text 3做中文输入，没太在意这个部分，但是最近开始了写博客，总不可能一直写英文，Sublime又是我一直用来的编辑器，虽然有点麻烦，但是还是配置起来用。</p>
<p>经过测试，中文输入是支持了，但是我用的FZUG源的搜狗输入法并不稳定，经常会崩溃到无法关机。<br>后来我换了Google的拼音输入法，目前还未崩溃。</p>
<h2 id="环境支持"><a href="#环境支持" class="headerlink" title="环境支持"></a>环境支持</h2><ol>
<li>操作系统为Fedora 25.</li>
<li>fcitx</li>
<li>Sublime Text 3</li>
<li>(可选)懒人可以通过<a target="_blank" rel="noopener" href="https://github.com/FZUG/repo/wiki/%E6%B7%BB%E5%8A%A0-FZUG-%E6%BA%90">添加FZUG源</a>，然后省去复杂的安装搜狗输入法(<font color="red">不推荐</font>)步骤，细节在接下来内容介绍。</li>
</ol>
<h2 id="卸载iBus，安装fcitx"><a href="#卸载iBus，安装fcitx" class="headerlink" title="卸载iBus，安装fcitx"></a>卸载iBus，安装fcitx</h2><p>Fedora一般默认安装的输入法管理器是<code>iBus</code>,而如果要把中文输入到Sublime Text 3中，则需要<code>fcitx</code>，所以使用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo dnf remove ibus</span><br></pre></td></tr></table></figure>
<p>卸载iBus，以及关闭GNOME对iBus的支持:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gsettings <span class="built_in">set</span> org.gnome.settings-daemon.plugins.keyboard active <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>安装fcitx:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo sudo install fcitx fcitx-configtool -y</span><br></pre></td></tr></table></figure>

<p>指定输入法模块:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vim ~/.bashrc</span><br></pre></td></tr></table></figure>

<p>在文件末尾添加:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export GTK_IM_MODULE=fcitx</span><br><span class="line">export QT_IM_MODULE=fcitx</span><br><span class="line">export XMODIFIERS="@im=fcitx"</span><br></pre></td></tr></table></figure>

<p>安装中文拼音输入法:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo dnf install fcitx-googlepinyin fcitx-cloudpinyin -y</span><br></pre></td></tr></table></figure>

<p>注销或者重启系统，通过<code>Ctrl+Space</code>就可以切换输入法。<br>或者将鼠标指向屏幕左下方，会出现:<br><img src="/2017/11/01/Fedora-25%E4%B8%8B%E5%BC%80%E5%90%AFSublime-Text-3%E7%9A%84%E4%B8%AD%E6%96%87%E8%BE%93%E5%85%A5%E6%94%AF%E6%8C%81/Screenshotfrom2017-11-01-10-50-35.png"><br>点击之后:<br><img src="/2017/11/01/Fedora-25%E4%B8%8B%E5%BC%80%E5%90%AFSublime-Text-3%E7%9A%84%E4%B8%AD%E6%96%87%E8%BE%93%E5%85%A5%E6%94%AF%E6%8C%81/Screenshotfrom2017-11-01-11-10-46.png"><br>选择google输入法:<br><img src="/2017/11/01/Fedora-25%E4%B8%8B%E5%BC%80%E5%90%AFSublime-Text-3%E7%9A%84%E4%B8%AD%E6%96%87%E8%BE%93%E5%85%A5%E6%94%AF%E6%8C%81/Screenshotfrom2017-11-01-11-10-51.png"></p>
<p>在配置中选择<code>Addon</code>，在底下的搜索栏搜索<code>cloud</code>得到<code>Cloud Pinyin</code>，双击设置:<br><img src="/2017/11/01/Fedora-25%E4%B8%8B%E5%BC%80%E5%90%AFSublime-Text-3%E7%9A%84%E4%B8%AD%E6%96%87%E8%BE%93%E5%85%A5%E6%94%AF%E6%8C%81/Screenshotfrom2017-11-01-11-16-11.png"></p>
<p>修改云拼音源为<code>baidu</code>，这样就不会因为被墙而使用不了云拼音。</p>
<h2 id="添加插件使得Sublime-Text-3支持中文输入"><a href="#添加插件使得Sublime-Text-3支持中文输入" class="headerlink" title="添加插件使得Sublime Text 3支持中文输入"></a>添加插件使得Sublime Text 3支持中文输入</h2><p>笔者假定Sublime Text 3已经安装好，并且目录为<code>/opt/sublime-text</code>。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/lyfeyaj/sublime-text-imfix/blob/master/src/sublime-imfix.c">下载插件源码</a></p>
<p>就这个文件就可以了。</p>
<p>执行命令生成动态库:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gcc -shared -o libsublime-imfix.so sublime-imfix.c `pkg-config --libs --cflags gtk+-2.0` -fPIC</span><br></pre></td></tr></table></figure>

<p><font color="red">注意</font>: 如果编译报错缺失<code>&lt;gtk/gtk.h&gt;</code>，证明系统缺少gtk2.0库的支持，执行命令:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo dnf install gtk2-devel -y</span><br></pre></td></tr></table></figure>
<p>补全依赖，再次执行编译动态库命令。</p>
<p>先执行:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ LD_PRELOAD=./libsublime-imfix.so sublime_text</span><br></pre></td></tr></table></figure>

<p>测试sublime能否支持中文输入，一般都是可以了。<br>通过的话，执行:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cp</span> ./libsublime-imfix.so /opt/sublime-text/</span><br></pre></td></tr></table></figure>
<p>将动态库复制到sublime的目录下。</p>
<p>之后修改:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vim /usr/share/applications/sublime_text.desktop</span><br></pre></td></tr></table></figure>

<p>将原来的:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Exec=/opt/sublime-text/sublime_text %F</span><br></pre></td></tr></table></figure>
<p>改为:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Exec=bash -c "LD_PRELOAD=/opt/sublime-text/libsublime-imfix.so exec /opt/sublime-text/sublime_text %F"</span><br></pre></td></tr></table></figure>

<p>至此，从GNOME启动sublime text 3可以支持fcitx的中文输入了。</p>
<p>(可选1):修改<code>/usr/bin/subl</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">LD_PRELOAD=/opt/sublime-text/libsublime-imfix.so</span><br><span class="line">/opt/sublime-text/sublime_text "$@"</span><br></pre></td></tr></table></figure>

<p>(可选2):添加一行到<code>/etc/profile</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LD_PRELOAD=/opt/sublime-text/libsublime-imfix.so</span><br></pre></td></tr></table></figure>

<p>笔者最近将系统更新到了<code>Fedora 27</code>，上述的配置已经无效了，尝试了网上一些方法之后最终放弃了，更改为用<code>iBus</code>+<code>VSCode</code>方案，目前流畅使用中。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://cfwloader.github.io/2017/11/01/Fedora-25%E4%B8%8B%E5%BC%80%E5%90%AFSublime-Text-3%E7%9A%84%E4%B8%AD%E6%96%87%E8%BE%93%E5%85%A5%E6%94%AF%E6%8C%81/" data-id="clximfz6o00157kkvd2d150mg" data-title="Fedora 25下开启Sublime Text 3的中文输入支持" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Fedora-25/" rel="tag">Fedora 25</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Sublime-Text-3/" rel="tag">Sublime Text 3</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%B7%A5%E5%85%B7%E9%85%8D%E7%BD%AE/" rel="tag">工具配置</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-hexo+github配置" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/10/31/hexo+github%E9%85%8D%E7%BD%AE/" class="article-date">
  <time class="dt-published" datetime="2017-10-31T02:47:44.000Z" itemprop="datePublished">2017-10-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Linux/">Linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/10/31/hexo+github%E9%85%8D%E7%BD%AE/">hexo+github配置</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="需要的环境"><a href="#需要的环境" class="headerlink" title="需要的环境"></a>需要的环境</h2><ol>
<li>git</li>
<li>npm</li>
<li>nodejs</li>
</ol>
<p>笔者使用的是Fedora 25，所以使用dnf命令就可以把这个两个工具快速安装了，nodejs也可以通过dnf快速安装到系统中。</p>
<h2 id="Github上的准备"><a href="#Github上的准备" class="headerlink" title="Github上的准备"></a>Github上的准备</h2><p>在github上建立一个与自己用户名对应的仓库，仓库名为”${用户名}.github.io”。<br>在本地上新建一个目录，用于存储hexo博客的工程内容，我就建立了一个”blog”作为hexo的根目录，只需要记得根目录路径即可，很多操作直接在根目录上使用hexo命令。</p>
<h2 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h2><p>在前面提及的工具已经安装的情况下，使用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo npm install -g hexo</span><br></pre></td></tr></table></figure>
<p>安装hexo。</p>
<h2 id="初始化以及配置Hexo工程"><a href="#初始化以及配置Hexo工程" class="headerlink" title="初始化以及配置Hexo工程"></a>初始化以及配置Hexo工程</h2><p>进入blog目录，执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo init</span><br></pre></td></tr></table></figure>
<p>初始化目录。</p>
<p>生成静态页面:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>或者简化的命令参数:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo g</span><br></pre></td></tr></table></figure>

<p>然后可以使用:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>使用浏览器访问<a target="_blank" rel="noopener" href="http://localhost:4000/">http://localhost:4000</a>即可看到搭建起来的本地博客。</p>
<h3 id="将Hexo本地工程部署到远程站点上"><a href="#将Hexo本地工程部署到远程站点上" class="headerlink" title="将Hexo本地工程部署到远程站点上"></a>将Hexo本地工程部署到远程站点上</h3><p>在blog本地根目录下有一个名为<code>_config.yml</code>的配置文件，用于配置整个hexo工程。</p>
<p>使用:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vim _config.yml</span><br></pre></td></tr></table></figure>
<p>打开， 其他平台或者编辑器的使用者请自行使用熟悉的编辑器。</p>
<p>到了文件末尾会有一段<code>deploy</code>开头的配置。<br>修改成如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">	type: git</span><br><span class="line">	repo: ${之前在github仓库上创建的仓库的git或者http链接}</span><br><span class="line">	branch: master</span><br></pre></td></tr></table></figure>

<p>例如我的配置:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">	type: git</span><br><span class="line">	repo: git@github.com:CFWLoader/CFWLoader.github.io.git</span><br><span class="line">	branch: master</span><br></pre></td></tr></table></figure>

<p>然后执行命令:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>
<p>保存配置。</p>
<p>最后，执行:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>将本地的修改提交到github仓库上，并会部署到站点上运行应用。</p>
<p>使用浏览器访问建立的仓库名则可以看到部署的博客站点，例如我的站点是<a href="http://cfwloader.github.io/">http://cfwloader.github.io</a></p>
<p>至此github + hexo的基本配置结束。</p>
<h2 id="部署事项"><a href="#部署事项" class="headerlink" title="部署事项"></a>部署事项</h2><p>每一次编辑并发布，请按照下列命令执行:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ hexo clean</span><br><span class="line">$ hexo generate</span><br><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<h2 id="开启Hexo文章分类功能"><a href="#开启Hexo文章分类功能" class="headerlink" title="开启Hexo文章分类功能"></a>开启Hexo文章分类功能</h2><p>在项目目录下，编辑<code>scaffolds/post.md</code>，修改内容为:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: {{ title }}</span><br><span class="line">date: {{ date }}</span><br><span class="line">tags:</span><br><span class="line">categories:</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<p>之后使用<code>hexo new</code>产生新文章时，在categories中填入文章的分类，hexo会自动产生分类栏。</p>
<p>因为一般我们采用的是中文，所以产生出来的页面的路径也包含中文，如果需要将分类与路径分离，可以修改<code>_config.yml</code>中<code>category_map</code>，有兴趣的可以自己去探索探索，这里不展开介绍了。</p>
<h2 id="Hexo标签功能"><a href="#Hexo标签功能" class="headerlink" title="Hexo标签功能"></a>Hexo标签功能</h2><p>Hexo自带的模板的文章头就有<code>tags</code>选项，之前学习搭建hexo的时候别的文章提到有多个标签的时候有两种填法。<br>一种是:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tags: [tag1, tag2, ..., tag`n`]</span><br></pre></td></tr></table></figure>

<p>另一种是:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tags:</span><br><span class="line">	-tag1</span><br><span class="line">	-tag2</span><br><span class="line">	...</span><br><span class="line">	-tag`n`</span><br></pre></td></tr></table></figure>

<p>笔者使用的<code>hexo-cli</code>版本是<code>1.0.4</code>，只有第二种方法才能正确产生期望的标签样式。故采用第二种方法。</p>
<h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><p>新建文章:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"<span class="variable">${文章名}</span>"</span></span><br></pre></td></tr></table></figure>

<p>新建页面:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new page <span class="string">"<span class="variable">${页面名}</span>"</span></span><br></pre></td></tr></table></figure>

<p>生成页面:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo g</span><br></pre></td></tr></table></figure>

<p>部署应用到站点上:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>更多:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo <span class="built_in">help</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://cfwloader.github.io/2017/10/31/hexo+github%E9%85%8D%E7%BD%AE/" data-id="clximfz6t002h7kkvhje96s3n" data-title="hexo+github配置" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Fedora-25/" rel="tag">Fedora 25</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/github/" rel="tag">github</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hexo/" rel="tag">hexo</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%B7%A5%E5%85%B7%E9%85%8D%E7%BD%AE/" rel="tag">工具配置</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/4/">&laquo; zurück</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Kategorien</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/C-%E6%8A%80%E6%9C%AF/">C++技术</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java%E6%8A%80%E6%9C%AF/">Java技术</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/">工具使用</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/">数学基础</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98/">数据挖掘</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/">网络通信</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Anderson-Darling%E6%A3%80%E9%AA%8C/" rel="tag">Anderson Darling检验</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Apache/" rel="tag">Apache</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C-11/" rel="tag">C++11</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C4-5/" rel="tag">C4.5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Effective-C/" rel="tag">Effective C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fedora-25/" rel="tag">Fedora 25</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GUI/" rel="tag">GUI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gems/" rel="tag">Gems</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/" rel="tag">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Github/" rel="tag">Github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hadoop/" rel="tag">Hadoop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ID3/" rel="tag">ID3</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaFX/" rel="tag">JavaFX</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Keras/" rel="tag">Keras</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kolmogorov-Smirnov%E6%A3%80%E9%AA%8C/" rel="tag">Kolmogorov Smirnov检验</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux%E5%91%BD%E4%BB%A4/" rel="tag">Linux命令</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Logsitic%E5%88%86%E5%B8%83/" rel="tag">Logsitic分布</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/" rel="tag">Markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MathJax/" rel="tag">MathJax</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/R/" rel="tag">R</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RHEL/" rel="tag">RHEL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RHEL-7-5/" rel="tag">RHEL 7.5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RailsInstaller/" rel="tag">RailsInstaller</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ruby/" rel="tag">Ruby</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Scala/" rel="tag">Scala</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spark/" rel="tag">Spark</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sublime-Text-3/" rel="tag">Sublime Text 3</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TCP/" rel="tag">TCP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tomcat/" rel="tag">Tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VC%E7%BB%B4/" rel="tag">VC维</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/" rel="tag">Windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ZCA/" rel="tag">ZCA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fxml/" rel="tag">fxml</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gdb/" rel="tag">gdb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/" rel="tag">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/k%E8%BF%91%E9%82%BB/" rel="tag">k近邻</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BF%A1%E6%81%AF%E5%A2%9E%E7%9B%8A/" rel="tag">信息增益</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BF%A1%E6%81%AF%E5%A2%9E%E7%9B%8A%E6%AF%94/" rel="tag">信息增益比</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E7%B1%BB%E6%A0%91/" rel="tag">分类树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%9D%97/" rel="tag">动态加载模块</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%B7%E7%A7%AF%E5%B1%82/" rel="tag">卷积层</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9D%90%E6%A0%87%E5%8F%98%E6%8D%A2/" rel="tag">坐标变换</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA/" rel="tag">多层感知机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag">学习笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B7%A5%E5%85%B7%E9%85%8D%E7%BD%AE/" rel="tag">工具配置</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%84%E5%90%91%E5%9F%BA%E7%BD%91%E7%BB%9C/" rel="tag">径向基网络</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AA%E7%8E%AF%E5%B1%82/" rel="tag">循环层</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%84%9F%E7%9F%A5%E6%9C%BA/" rel="tag">感知机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8A%80%E5%B7%A7%E6%96%B9%E6%B3%95/" rel="tag">技巧方法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/" rel="tag">支持向量机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/" rel="tag">数学基础</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98/" rel="tag">数据挖掘</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" rel="tag">机器学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%B8%E5%87%BD%E6%95%B0/" rel="tag">核函数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A6%82%E7%8E%87%E6%A8%A1%E5%9E%8B/" rel="tag">概率模型</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A6%82%E7%8E%87%E8%AE%BA/" rel="tag">概率论</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" rel="tag">深度学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%89%B9%E5%BE%81%E5%88%86%E8%A7%A3/" rel="tag">特征分解</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9F%A9%E9%98%B5/" rel="tag">矩阵</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0/" rel="tag">算法实现</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8/" rel="tag">系统调用</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4/" rel="tag">系统运维</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/" rel="tag">线性代数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%83%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag">练习笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%9F%E8%AE%A1%E5%AD%A6/" rel="tag">统计学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%9F%E8%AE%A1%E7%90%86%E8%AE%BA/" rel="tag">统计理论</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/" rel="tag">网络通信</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%A7%A3%E6%9E%90%E5%87%A0%E4%BD%95/" rel="tag">解析几何</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%A2%91%E7%B9%81%E6%A8%A1%E5%BC%8F%E6%8C%96%E6%8E%98/" rel="tag">频繁模式挖掘</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/" rel="tag">高等数学</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Anderson-Darling%E6%A3%80%E9%AA%8C/" style="font-size: 10px;">Anderson Darling检验</a> <a href="/tags/Apache/" style="font-size: 10px;">Apache</a> <a href="/tags/C/" style="font-size: 11.43px;">C</a> <a href="/tags/C/" style="font-size: 20px;">C++</a> <a href="/tags/C-11/" style="font-size: 18.57px;">C++11</a> <a href="/tags/C4-5/" style="font-size: 10px;">C4.5</a> <a href="/tags/Effective-C/" style="font-size: 18.57px;">Effective C++</a> <a href="/tags/Fedora-25/" style="font-size: 12.86px;">Fedora 25</a> <a href="/tags/GUI/" style="font-size: 10px;">GUI</a> <a href="/tags/Gems/" style="font-size: 10px;">Gems</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Github/" style="font-size: 10px;">Github</a> <a href="/tags/Hadoop/" style="font-size: 10px;">Hadoop</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/ID3/" style="font-size: 10px;">ID3</a> <a href="/tags/Java/" style="font-size: 11.43px;">Java</a> <a href="/tags/JavaFX/" style="font-size: 10px;">JavaFX</a> <a href="/tags/Keras/" style="font-size: 11.43px;">Keras</a> <a href="/tags/Kolmogorov-Smirnov%E6%A3%80%E9%AA%8C/" style="font-size: 10px;">Kolmogorov Smirnov检验</a> <a href="/tags/Linux/" style="font-size: 15.71px;">Linux</a> <a href="/tags/Linux%E5%91%BD%E4%BB%A4/" style="font-size: 10px;">Linux命令</a> <a href="/tags/Logsitic%E5%88%86%E5%B8%83/" style="font-size: 10px;">Logsitic分布</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/MathJax/" style="font-size: 10px;">MathJax</a> <a href="/tags/R/" style="font-size: 17.14px;">R</a> <a href="/tags/RHEL/" style="font-size: 10px;">RHEL</a> <a href="/tags/RHEL-7-5/" style="font-size: 10px;">RHEL 7.5</a> <a href="/tags/RailsInstaller/" style="font-size: 10px;">RailsInstaller</a> <a href="/tags/Ruby/" style="font-size: 10px;">Ruby</a> <a href="/tags/Scala/" style="font-size: 10px;">Scala</a> <a href="/tags/Spark/" style="font-size: 10px;">Spark</a> <a href="/tags/Sublime-Text-3/" style="font-size: 10px;">Sublime Text 3</a> <a href="/tags/TCP/" style="font-size: 11.43px;">TCP</a> <a href="/tags/Tomcat/" style="font-size: 10px;">Tomcat</a> <a href="/tags/VC%E7%BB%B4/" style="font-size: 10px;">VC维</a> <a href="/tags/Windows/" style="font-size: 11.43px;">Windows</a> <a href="/tags/ZCA/" style="font-size: 10px;">ZCA</a> <a href="/tags/fxml/" style="font-size: 10px;">fxml</a> <a href="/tags/gdb/" style="font-size: 10px;">gdb</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/k%E8%BF%91%E9%82%BB/" style="font-size: 10px;">k近邻</a> <a href="/tags/python/" style="font-size: 12.86px;">python</a> <a href="/tags/%E4%BF%A1%E6%81%AF%E5%A2%9E%E7%9B%8A/" style="font-size: 10px;">信息增益</a> <a href="/tags/%E4%BF%A1%E6%81%AF%E5%A2%9E%E7%9B%8A%E6%AF%94/" style="font-size: 10px;">信息增益比</a> <a href="/tags/%E5%88%86%E7%B1%BB%E6%A0%91/" style="font-size: 10px;">分类树</a> <a href="/tags/%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%9D%97/" style="font-size: 10px;">动态加载模块</a> <a href="/tags/%E5%8D%B7%E7%A7%AF%E5%B1%82/" style="font-size: 10px;">卷积层</a> <a href="/tags/%E5%9D%90%E6%A0%87%E5%8F%98%E6%8D%A2/" style="font-size: 10px;">坐标变换</a> <a href="/tags/%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA/" style="font-size: 12.86px;">多层感知机</a> <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="font-size: 11.43px;">学习笔记</a> <a href="/tags/%E5%B7%A5%E5%85%B7%E9%85%8D%E7%BD%AE/" style="font-size: 12.86px;">工具配置</a> <a href="/tags/%E5%BE%84%E5%90%91%E5%9F%BA%E7%BD%91%E7%BB%9C/" style="font-size: 10px;">径向基网络</a> <a href="/tags/%E5%BE%AA%E7%8E%AF%E5%B1%82/" style="font-size: 10px;">循环层</a> <a href="/tags/%E6%84%9F%E7%9F%A5%E6%9C%BA/" style="font-size: 10px;">感知机</a> <a href="/tags/%E6%8A%80%E5%B7%A7%E6%96%B9%E6%B3%95/" style="font-size: 10px;">技巧方法</a> <a href="/tags/%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/" style="font-size: 10px;">支持向量机</a> <a href="/tags/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/" style="font-size: 12.86px;">数学基础</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98/" style="font-size: 12.86px;">数据挖掘</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="font-size: 18.57px;">机器学习</a> <a href="/tags/%E6%A0%B8%E5%87%BD%E6%95%B0/" style="font-size: 10px;">核函数</a> <a href="/tags/%E6%A6%82%E7%8E%87%E6%A8%A1%E5%9E%8B/" style="font-size: 10px;">概率模型</a> <a href="/tags/%E6%A6%82%E7%8E%87%E8%AE%BA/" style="font-size: 10px;">概率论</a> <a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" style="font-size: 11.43px;">深度学习</a> <a href="/tags/%E7%89%B9%E5%BE%81%E5%88%86%E8%A7%A3/" style="font-size: 11.43px;">特征分解</a> <a href="/tags/%E7%9F%A9%E9%98%B5/" style="font-size: 10px;">矩阵</a> <a href="/tags/%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0/" style="font-size: 12.86px;">算法实现</a> <a href="/tags/%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8/" style="font-size: 10px;">系统调用</a> <a href="/tags/%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4/" style="font-size: 10px;">系统运维</a> <a href="/tags/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/" style="font-size: 14.29px;">线性代数</a> <a href="/tags/%E7%BB%83%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="font-size: 17.14px;">练习笔记</a> <a href="/tags/%E7%BB%9F%E8%AE%A1%E5%AD%A6/" style="font-size: 11.43px;">统计学</a> <a href="/tags/%E7%BB%9F%E8%AE%A1%E7%90%86%E8%AE%BA/" style="font-size: 10px;">统计理论</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/" style="font-size: 10px;">网络通信</a> <a href="/tags/%E8%A7%A3%E6%9E%90%E5%87%A0%E4%BD%95/" style="font-size: 10px;">解析几何</a> <a href="/tags/%E9%A2%91%E7%B9%81%E6%A8%A1%E5%BC%8F%E6%8C%96%E6%8E%98/" style="font-size: 12.86px;">频繁模式挖掘</a> <a href="/tags/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/" style="font-size: 10px;">高等数学</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">letzter Beitrag</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/07/05/Git%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB/">Git问题汇总</a>
          </li>
        
          <li>
            <a href="/2018/12/10/%E9%80%BB%E8%BE%91%E6%96%AF%E8%B0%9B%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B/">逻辑斯谛回归模型</a>
          </li>
        
          <li>
            <a href="/2018/10/17/%E5%86%B3%E7%AD%96%E6%A0%91%E4%B9%8BID3%E4%B8%8EC4-5/">决策树之ID3与C4.5</a>
          </li>
        
          <li>
            <a href="/2018/10/12/Spark%E9%85%8D%E7%BD%AE%E7%AC%94%E8%AE%B0/">Spark配置笔记</a>
          </li>
        
          <li>
            <a href="/2018/08/14/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%BB%83%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%B9%9D/">机器学习练习笔记(九)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 Evan Huang<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>